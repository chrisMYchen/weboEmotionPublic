/*
 * Utilities to more easily create temporary files needed for testing and ensuring
 * the files are cleaned up easily and don't interfere with other tests
 */
var path = require("path"),
    fs = require("fs-extra");

var temp = {

    /*
     * Setup the temp directory, ensuring it exists, and cleaning up files
     * left over from other tests that didn't properly clean up after themselves
     */
    setup: function(){
        // NOTE: For now this is the same implementation, but just in case we
        // we want to do something smarter like catch tests that don't cleanup
        // this gives as an entry point to do so
        temp.cleanup();
    },

    /*
     * Remove any existing files in the temp directory.
     *
     * Tests should call this to cleanup after themselves.
     */
    cleanup: function(){
        fs.emptyDirSync(temp.path(""));
    },

    /*
     * @param path {String} Path to be used relative to temp directory
     * @returns {String} Absolute path that can be used to write the file to the temp folder
     */
    path: function(filePath){
        return path.resolve(__dirname, "../temp", filePath);
    }
};

module.exports = temp;

/** 
 * jibo - jibo api
 * @version v3.0.7
 * Copyright (c) 2016, Jibo, Inc. All rights reserved.
 * All use of the Jibo SDK is subject to the Jibo SDK End User License Agreement (EULA) 
 * distributed herewith.  If you did not receive a copy of the EULA, you may view a
 * copy at https://developers.jibo.com/license.
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.jibo=t()}}(function(){return function t(e,i,n){function o(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[s]={exports:{}};e[s][0].call(l.exports,function(t){var i=e[s][1][t];return o(i?i:t)},l,l.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,i){"use strict";var n=t("animation-utilities"),o=t("path"),r=t("fs"),s=t("async"),a=t("./sound/SoundLibrary"),u=t("./utils/perf/GlobalPerfTimer"),c=t("./utils/perf/SerialTimer"),l=t("./utils/perf/ParallelTimer"),p=null;try{p=t("ipc")}catch(h){console.warn("Not running inside Electron")}var d=function(){function e(t){var e=this;if(GLOBAL.jibo)throw new Error("Jibo Singleton may only be initialized once.");GLOBAL.jibo=this,this.utils=t.utils,this.services=t.services,this.animate=n.animate.createAnimationUtilities(),this.asr=new t.services.asr.ASRService,this.bt=new t.bt.Factory(t.bt),this.nlu=new t.services.NLUService,this.lps=new t.services.LPSService,this.tts=new t.services.TTSService,this.body=new t.services.BodyService,this.audio=new t.services.AudioService,this.timer=new t.utils.Timer,this.face=new t.FaceRenderer(this.timer),this.FaceRenderer=t.FaceRenderer,this.sound=new a["default"],this.utils.SoundUtils=t.sound.SoundUtils,this.session=new t.services.SessionManager,this.systemManager=new t.services.SystemManager,this.behaviorEmitter=new t.bt.BehaviorEmitter,this.visualize=n.visualize,this.options=null,this._serviceInit={tts:function(t,i){e.tts.init(t,i)},lps:function(t,i){e.lps.init(t,i)},body:function(t,i){var o="ws:"+t.host+":"+t.port,r=new n.body.BodyPosVelOutput(e.visualize.timeline.getClock(),e.visualize.robotInfo,o,!0,33);e.visualize.timeline.addOutput(r,null);var s=new n.LEDOutput(e.visualize.timeline.getClock(),e.visualize.robotInfo,o,!0,33);e.visualize.timeline.addOutput(s,null),e.body.init(t,i)},nlu:function(t,i){e.nlu.init(t,i)},asr:function(t,i){e.asr.init(t,i)},systemManager:function(t,i){e.systemManager.init(t,i)},audio:function(t,i){e.audio.init(t,i)}}}return e.prototype.requireAssetPack=function(e){if(r.existsSync(e)){var i=t(e);if(i.jibo&&"asset-pack"===i.jibo.type){var n=o.resolve(o.parse(e).dir,i.main);return t(n)}}},e.prototype.init=function(t,e){var i=this;return"function"==typeof t?(e=t,t=null):("string"==typeof t||t instanceof HTMLElement)&&(t={display:t}),this.options=Object.assign({display:null},t||{}),"function"!=typeof e?new Promise(function(t,e){i._init(function(i){i?e(i):t()})}):void this._init(e)},e.prototype._init=function(t){var i=this;if(e.isInitializing||e.isInitialized)throw new Error("Jibo Singleton may only be initialized once.");e.isInitializing=!0;var n=function(t){i.initNetworkServices(t)},o=function(t){var e=new c["default"]("initAnimate",u["default"].get());i.utils.AnimationUtils.init(i.animate,function(){e.stop(),t.apply(this,arguments)})};s.series([o,n],function(n){if(n){var o='<div style="position:absolute;top:0px;left:0px;width:100%;height:100%;z-index:999999;background:#a7a7a7;text-align:center;">';o+='<span style="position:absolute;top:250px;left:0px;font-size:44px;font-weight:bold;font-family:Arial;color:#c50000;padding:20px;">'+n+"</span>",o+="</div>",document.body.innerHTML+=o,t(n)}else{var r=i.options.display;if(r){if("string"==typeof r&&(r=document.getElementById(r)),!r)throw new Error("Display canvas element is invalid");i.visualize.createFaceRenderer(r)}e.isInitialized=!0,i.timer.start(),t()}})},e.prototype.initNetworkServices=function(t){var e,i,n=this,o=new c["default"]("initNetworkServices",u["default"].get());s.series([function(t){var i=new c["default"]("getRegistryHost",o);return p?void p.on("set-registry-host",function(o){"string"==typeof o||o instanceof String?e=o:(e=o.registryHost,o.token&&(n.session.token=o.token,console.warn("Session Token = "+n.session.token))),i.stop(),t(null,null)}):(i.stop(),t(null,null))},function(t){var n=new c["default"]("fetchServicesTimer",o),r=new XMLHttpRequest;r.timeout=3e3,r.onreadystatechange=function(){4===r.readyState&&200===r.status?(i=JSON.parse(r.responseText),i.records&&(i=i.records,i.sort(function(t,e){return"system-manager"===t.name?-1:"system-manager"===e.name?1:-1})),n.stop(),t(null,null)):4===r.readyState&&0===r.status&&t(new Error("Could not find registry service at "+e),null)},r.open("GET",e,!0),r.send(null)},function(t){var e=new l["default"]("parallelInitializedServices",o),r=[];i.forEach(function(t){var i=n._serviceInit[t.name];"system-manager"===t.name&&(i=n._serviceInit.systemManager),i&&r.push(function(n){var o=new c["default"](t.name,e);i(t,function(t,e){o.stop(),n.apply(this,arguments)})})}),s.parallel(r,function(i,n){i?(console.error("Error: "+i),t(i,null)):(e.stop(),t(null,n))})}],function(e,i){e?(console.error("Error: "+e),t(e)):(o.stop(),u["default"].get().stop(),t(null,i))}),p&&p.send("get-registry-host")},Object.defineProperty(e,"instance",{get:function(){return GLOBAL.jibo},enumerable:!0,configurable:!0}),e.isInitializing=!1,e.isInitialized=!1,e}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=d},{"./sound/SoundLibrary":83,"./utils/perf/GlobalPerfTimer":92,"./utils/perf/ParallelTimer":93,"./utils/perf/SerialTimer":95,"animation-utilities":void 0,async:void 0,fs:void 0,ipc:void 0,path:void 0}],2:[function(t,e,i){"use strict";var n=t("./Status"),o=function(){function t(t,e){this._status=n["default"].INVALID,t=t||{},e=e||{},this.options=Object.assign({name:"",emitter:null,blackboard:null,assetPack:""},e,t),this._status=n["default"].INVALID,this.blackboard=this.options.blackboard,this.emitter=this.options.emitter,this.assetPack=this.options.assetPack||""}return Object.defineProperty(t.prototype,"name",{get:function(){return this.options.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentStatus",{get:function(){return this._status},enumerable:!0,configurable:!0}),t.prototype.start=function(){return!0},t.prototype.stop=function(){},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=o},{"./Status":10}],3:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./Status"),r=t("./BaseElement"),s=function(t){function e(e,i){void 0===i&&(i={}),t.call(this,e,Object.assign({decorators:[]},i||{})),this.decorators=this.options.decorators,this.parent=null,this.waitDecorators=[],this.waitDecoratorsLength=0}return n(e,t),Object.defineProperty(e.prototype,"decorators",{get:function(){return this._decorators},set:function(t){var e=this;this._decorators=t,t.forEach(function(t){t.behavior=e})},enumerable:!0,configurable:!0}),e.prototype._pause=function(){this.previousStatus=this._status,this._status=o["default"].PAUSED},e.prototype._unpause=function(){this._status=this.previousStatus},e.prototype._start=function(){if(this._status===o["default"].IN_PROGRESS)return!1;if(this.waitDecorators.length=this.waitDecoratorsLength=0,this._decorators.length)for(var t=0;t<this._decorators.length;t++){var e=this._decorators[t]._start();if(e===o["default"].WAIT)this.waitDecorators.push(this._decorators[t]),this.waitDecoratorsLength++;else if(!e)return this._status=o["default"].FAILED,this._stop(),!1}if(0===this.waitDecorators.length){var e=this.start();return this._status=e?o["default"].IN_PROGRESS:o["default"].FAILED,e||this._stop(),e}return this._status=o["default"].IN_PROGRESS,!0},e.prototype._stop=function(){this._decorators.length&&this._decorators.forEach(function(t){t._status===o["default"].IN_PROGRESS&&t._stop()}),this._status===o["default"].IN_PROGRESS&&(this._status=o["default"].INTERRUPTED,this.stop())},e.prototype._update=function(){if(this.waitDecoratorsLength>0){for(var t=0;t<this.waitDecorators.length;t++)if(this.waitDecorators[t]){var e=this.waitDecorators[t]._update(this._status);e!==o["default"].WAIT&&(this.waitDecoratorsLength--,this.waitDecorators[t]=null)}if(0!==this.waitDecoratorsLength)return o["default"].IN_PROGRESS;var i=this.start();this._status=i?o["default"].IN_PROGRESS:o["default"].FAILED,i||this._stop()}if(this._status===o["default"].PAUSED){var n=this._status;if(this._decorators.length)for(var t=0;t<this._decorators.length;t++)if(n=this._decorators[t]._update(this._status),n!==o["default"].IN_PROGRESS)return this._stop(),n;return this._status}if(this._status===o["default"].IN_PROGRESS){var r=this.update();if(r!==o["default"].IN_PROGRESS&&(this._status=r,this._stop()),this._decorators.length)for(var t=0;t<this._decorators.length;t++)if(r=this._decorators[t]._update(this._status),r!==o["default"].IN_PROGRESS)return this._stop(),this._status=r,this._status;return this._status}return this._status===o["default"].SUCCEEDED?o["default"].SUCCEEDED:o["default"].FAILED},e}(r["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"./BaseElement":2,"./Status":10}],4:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("events"),r=function(t){function e(){t.call(this)}return n(e,t),e}(o.EventEmitter);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r},{events:void 0}],5:[function(t,e,i){"use strict";var n=function(){function t(t,e,i,n,o){this.root=t,this.blackboard=e,this.notepad=i,this.result=n,this.emitter=o}return Object.defineProperty(t.prototype,"status",{get:function(){return this.root._status},enumerable:!0,configurable:!0}),t.prototype.start=function(){return this.root._start()},t.prototype.stop=function(){this.root._stop()},t.prototype.pause=function(){this.root._pause()},t.prototype.unpause=function(){this.root._unpause()},t.prototype.update=function(){return this.root._update()},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n},{}],6:[function(t,e,i){"use strict";var n=function(){function t(){}return t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n},{}],7:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./Status"),r=t("./BaseElement"),s=function(t){function e(e,i){t.call(this,e,i),this.behavior=null}return n(e,t),e.prototype._start=function(){var t=this.start();return this._status=t?o["default"].IN_PROGRESS:o["default"].FAILED,t},e.prototype._stop=function(){this._status=o["default"].INTERRUPTED,this.stop()},e.prototype._update=function(t){return this._status=this.update(t),this._status},e}(r["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"./BaseElement":2,"./Status":10}],8:[function(t,e,i){"use strict";var n=t("path"),o=t("callsite"),r=t("./BehaviorEmitter"),s=t("./Blackboard"),a=t("./BehaviorTree"),u=t("./Status"),c=function(){function e(t){this._behaviors={},this.Status=u["default"],this.blackboard=new s["default"],Object.assign(this,t),this.registerCore()}return e.prototype.register=function(t,e,i){var n=this._behaviors[e];n||(n=this._behaviors[e]={}),n[t]=i},e.prototype.registerCore=function(){var t="core",e=Object.assign({},this.behaviors,this.decorators);for(var i in e)this.register(i,t,e[i])},e.prototype.create=function(e,i){void 0===i&&(i={});var s;if(e=e.substr(0,e.lastIndexOf(n.parse(e).ext)),n.isAbsolute(e))s=e;else{var u=o()[1].getFileName();s=n.join(u,"..",e)}var c;try{c=t(s)}catch(l){throw console.error(l),new Error(e+" is not a valid behavior tree")}var p,h,d,f,v,y=i.blackboard||this.blackboard,_=i.notepad||{},S={},m=new r["default"],b=c(y,_,S,m),g={},P=Object.keys(b),E="";for(p=0;p<P.length;p++){if(f=P[p],d=b[f],E=d["asset-pack"]||"core","project"===E&&i.assetPack&&(E=i.assetPack),v=this._behaviors[E],!v)throw new Error("Namespace '"+E+"' is not registered with the behavior factory");if(!v[d["class"]])throw new Error("Behavior '"+d["class"]+"' in namespace '"+E+"' is not registered with the behavior factory");if(Array.isArray(d.args))throw new Error("Behavior '"+d["class"]+"' options are invalid, re-run behaviorify");var O=v[d["class"]],R=Object.assign({name:d.name,emitter:m,blackboard:y,assetPack:i.assetPack||""},d.options||{});g[f]=new O(R)}var w={};for(p=0;p<P.length;p++)if(f=P[p],d=b[f],d.parent||(w[d.id]=!0),d.skipped)delete w[d.id];else{var T=g[d.id];if(d.children){var k=[];for(h=0;h<d.children.length;h++){var x=d.children[h],I=g[x];b[x].skipped||k.push(I)}T.children=k}if(d.decorators){var A=[];for(h=0;h<d.decorators.length;h++){var D=g[d.decorators[h]];delete w[d.decorators[h]],b[d.decorators[h]].skipped||A.push(D)}A.length>0&&(T.decorators=A)}}var N=g[Object.keys(w)[0]];return new a["default"](N,this.blackboard,_,S,m)},e}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=c},{"./BehaviorEmitter":4,"./BehaviorTree":5,"./Blackboard":6,"./Status":10,callsite:void 0,path:void 0}],9:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./Status"),r=t("./Behavior"),s=function(t){function e(e,i){t.call(this,e,Object.assign({children:[]},i||{})),this.children=this.options.children}return n(e,t),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},set:function(t){for(var e=0;e<t.length;e++)t[e].parent=this;this._children=t},enumerable:!0,configurable:!0}),e.prototype._stop=function(){this.children.length&&this.children.forEach(function(t){t._status===o["default"].IN_PROGRESS&&t._stop()}),t.prototype._stop.call(this)},e}(r["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"./Behavior":3,"./Status":10}],10:[function(t,e,i){"use strict";var n;!function(t){t[t.SUCCEEDED=0]="SUCCEEDED",t[t.FAILED=1]="FAILED",t[t.INTERRUPTED=2]="INTERRUPTED",t[t.IN_PROGRESS=3]="IN_PROGRESS",t[t.INVALID=4]="INVALID",t[t.PAUSED=5]="PAUSED",t[t.WAIT=6]="WAIT"}(n||(n={})),Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n},{}],11:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=t("../../Runtime"),a=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.start=function(){return s["default"].instance.animate.blink(),!0},e.prototype.update=function(){return r["default"].SUCCEEDED},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"../../Runtime":1,"../Behavior":3,"../Status":10}],12:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.start=function(){return this.options.exec(),!0},e.prototype.update=function(){return r["default"].SUCCEEDED},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Behavior":3,"../Status":10}],13:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=function(t){function e(e){t.call(this,e),this.status=r["default"].INVALID}return n(e,t),e.prototype.start=function(){return this.status=r["default"].IN_PROGRESS,this.options.exec(this.onSucceed.bind(this),this.onFail.bind(this)),!0},e.prototype.onSucceed=function(){this.status=r["default"].SUCCEEDED},e.prototype.onFail=function(){this.status=r["default"].FAILED},e.prototype.update=function(){return this.status},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Behavior":3,"../Status":10}],14:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("./Null"),s=t("../decorators/SucceedOnListen"),a=function(t){function e(e){t.call(this,e);var i=new s["default"]({getOptions:e.getOptions,rule:e.rule,onResult:e.onResult,emitter:this.emitter,blackboard:this.blackboard,assetPack:this.assetPack});this.behavior=new r["default"]({decorators:[i]})}return n(e,t),e.prototype.start=function(){return this.behavior._start()},e.prototype.stop=function(){this.behavior._stop()},e.prototype.update=function(){return this.behavior._update()},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"../Behavior":3,"../decorators/SucceedOnListen":41,"./Null":18}],15:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../decorators/SucceedOnEmbedded"),s=t("./Null"),a=function(t){function e(e){t.call(this,e);var i=new r["default"]({rule:this.options.rule,onResult:this.options.onResult,emitter:this.emitter,blackboard:this.blackboard,assetPack:this.assetPack});this.behavior=new s["default"]({decorators:[i]})}return n(e,t),e.prototype.start=function(){return this.behavior._start()},e.prototype.stop=function(){this.behavior._stop()},e.prototype.update=function(){return this.behavior._update()},e}(o["default"]);a.Rules={HEY_jibo:"hey_jibo"},Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"../Behavior":3,"../decorators/SucceedOnEmbedded":39,"./Null":18}],16:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../decorators/SucceedOnListenJs"),s=t("./Null"),a=function(t){function e(e){t.call(this,e);var i=new r["default"]({getOptions:e.getOptions,getRule:e.getRule,onResult:e.onResult,emitter:this.emitter,blackboard:this.blackboard,assetPack:this.assetPack});this.behavior=new s["default"]({decorators:[i]})}return n(e,t),e.prototype.start=function(){return this.behavior._start()},e.prototype.stop=function(){this.behavior._stop()},e.prototype.update=function(){return this.behavior._update()},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"../Behavior":3,"../decorators/SucceedOnListenJs":42,"./Null":18}],17:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=t("../../Runtime"),a=t("animation-utilities"),u=function(t){function e(e){t.call(this,e,{isContinuous:!1}),this.threeVec=new a.THREE.Vector3(0,0,0),this.status=r["default"].INVALID}return n(e,t),e.prototype.start=function(){this.status=r["default"].IN_PROGRESS,this.builder=s["default"].instance.animate.createLookatBuilder(),this.onStoppedBind=this.onStopped.bind(this),this.builder.on("STOPPED",this.onStoppedBind),this.builder.setContinuousMode(this.options.isContinuous),void 0!==this.options.config&&this.options.config(this.builder);var t=this.options.getTarget();return this.threeVec.set(t.x,t.y,t.z),this.lookAtInstance=this.builder.startLookat(this.threeVec),!0},e.prototype.onStopped=function(){this.status=r["default"].SUCCEEDED},e.prototype.stop=function(){this.lookAtInstance&&this.lookAtInstance.stop()},e.prototype.update=function(){if(this.options.isContinuous&&void 0!==this.lookAtInstance){var t=this.options.getTarget();this.threeVec.set(t.x,t.y,t.z),this.lookAtInstance.updateTarget(this.threeVec)}return this.status},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=u},{"../../Runtime":1,"../Behavior":3,"../Status":10,"animation-utilities":void 0}],18:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.update=function(){return r["default"].IN_PROGRESS},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Behavior":3,"../Status":10}],19:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../ParentBehavior"),r=t("../Status"),s=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.start=function(){if(0===this.children.length)return!1;var t=!1;this.runChildren=[];for(var e=0;e<this.children.length;e++){var i=this.children[e];i._start()?this.runChildren.push(i):t=!0}if(this.activeChildren=this.runChildren.length,t){for(var e=0;e<this.runChildren.length;e++)this.runChildren[e]._stop();return!1}return!0},e.prototype.stop=function(){for(var t=0;t<this.runChildren.length;t++)this.runChildren[t]&&this.runChildren[t]._stop()},e.prototype.update=function(){for(var t=!1,e=0;e<this.runChildren.length;e++)if(this.runChildren[e]){var i=this.runChildren[e],n=i._update();if(n===r["default"].SUCCEEDED){if(this.options.succeedOnOne)return this._stop(),r["default"].SUCCEEDED;i._stop(),delete this.runChildren[e],this.activeChildren--}else if(n===r["default"].FAILED)t=!0;else if(n===r["default"].PAUSED)return r["default"].IN_PROGRESS}return t?r["default"].FAILED:0===this.activeChildren?r["default"].SUCCEEDED:r["default"].IN_PROGRESS},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../ParentBehavior":9,"../Status":10}],20:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=t("../../Runtime"),a=t("../../utils/PathUtils"),u=function(t){function e(e){t.call(this,e),this.options.animPath=a["default"].setDefaultPath("animations",e.animPath),this.builder=null,this.onEvent=this.onEvent.bind(this),this.status=r["default"].INVALID}return n(e,t),e.prototype.start=function(){var t=this;return this.status=r["default"].IN_PROGRESS,a["default"].getAssetUri(this.options.animPath,this.assetPack,function(e,i){s["default"].instance.animate.createAnimationBuilderFromKeysPath(e,i,function(e){t.builder=e,t.builder?(e.on("STOPPED",function(){t.status=r["default"].SUCCEEDED}),e.on("EVENT",t.onEvent),t.options.config&&t.options.config(e),t.instance=e.play()):t.status=r["default"].FAILED})}),!0},e.prototype.stop=function(){this.builder&&(this.builder.off("EVENT",this.onEvent),this.instance.stop())},e.prototype.onEvent=function(t,e,i){s["default"].instance.behaviorEmitter.emit(i.eventName,e,i.payload)},e.prototype.update=function(){return this.status},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=u},{"../../Runtime":1,"../../utils/PathUtils":89,"../Behavior":3,"../Status":10}],21:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=t("../../utils/PathUtils"),a=t("../../sound/SoundUtils"),u=t("../../jibo"),c=function(t){function e(e){t.call(this,e),this.status=r["default"].INVALID,this.alias=null}return n(e,t),e.prototype.start=function(){var t=this;return this.status=r["default"].IN_PROGRESS,s["default"].getAudioUri(this.options.audioPath,this.assetPack,function(e){t.alias=a["default"].playOnce(e,function(){t.status=r["default"].SUCCEEDED,t.alias=null})}),!0},e.prototype.stop=function(){this.alias&&u["default"].sound.exists(this.alias)&&u["default"].sound.pause(this.alias)},e.prototype.update=function(){return this.status},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=c},{"../../jibo":50,"../../sound/SoundUtils":84,"../../utils/PathUtils":89,"../Behavior":3,"../Status":10}],22:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../ParentBehavior"),r=t("../Status"),s=function(t){function e(e){t.call(this,e),this.current=-1}return n(e,t),e.prototype.start=function(){if(0===this.children.length)return!1;this.current=Math.round(Math.random()*(this.children.length-1));var t=this.children[this.current]._start();return this.current=t?this.current:-1,t},e.prototype.stop=function(){-1!==this.current&&this.current<this.children.length&&(this.children[this.current]._stop(),this.current=-1)},e.prototype.update=function(){var t=this.children[this.current]._update();return t===r["default"].PAUSED?r["default"].IN_PROGRESS:t},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../ParentBehavior":9,"../Status":10}],23:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=t("../../Runtime"),a=function(t){function e(e){t.call(this,e),this.status=r["default"].INVALID}return n(e,t),e.prototype.start=function(){var t=this;return this.status=r["default"].IN_PROGRESS,s["default"].instance.lps.readBarcode(function(e,i){t.options.onBarcode(e,i),t.status=r["default"].SUCCEEDED}),!0},e.prototype.update=function(){return this.status},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"../../Runtime":1,"../Behavior":3,"../Status":10}],24:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../ParentBehavior"),r=t("../Status"),s=function(t){function e(e){t.call(this,e),this.current=-1}return n(e,t),e.prototype.start=function(){if(0===this.children.length)return!0;this.current=0;var t=this.children[this.current]._start();return this.current=t?this.current:-1,t},e.prototype.stop=function(){-1!==this.current&&this.current<this.children.length&&(this.current=-1)},e.prototype.update=function(){if(0===this.children.length||this.status===r["default"].SUCCEEDED)return r["default"].SUCCEEDED;for(;-1!==this.current&&this.current<this.children.length;){var t=this.children[this.current]._update();if(t!==r["default"].SUCCEEDED)return t===r["default"].IN_PROGRESS||t==r["default"].PAUSED?r["default"].IN_PROGRESS:r["default"].FAILED;if(this.current++,!(this.current<this.children.length))return r["default"].SUCCEEDED;var e=this.children[this.current]._start();if(!e)return r["default"].FAILED}return r["default"].SUCCEEDED},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../ParentBehavior":9,"../Status":10}],25:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=t("../../Runtime"),a=t("../../utils/PathUtils"),u=function(t){function e(e){t.call(this,e),e.behaviorPath&&(this.behaviorPath=e.behaviorPath),this.status=r["default"].INVALID,this.root=null}return n(e,t),Object.defineProperty(e.prototype,"behaviorPath",{set:function(t){this.options.behaviorPath=a["default"].setDefaultPath("behaviors",t),this.assetPack=a["default"].getAssetPack(t)},enumerable:!0,configurable:!0}),e.prototype.start=function(){var t=this;return this.status=r["default"].IN_PROGRESS,a["default"].getAssetUri(this.options.behaviorPath,this.assetPack,function(e){t.root=s["default"].instance.bt.create(e,{notepad:t.options.getNotepad(),blackboard:t.blackboard,assetPack:t.assetPack}),t.status=t.root.start()?t.status:r["default"].FAILED}),!0},e.prototype.stop=function(){this.root&&(this.root.stop(),this.root=null)},e.prototype.update=function(){if(this.status===r["default"].FAILED)return this.root=null,this.status;if(!this.root)return this.status;var t=this.root.update();return(t===r["default"].SUCCEEDED||t===r["default"].FAILED)&&(this.options.onResult(this.root.result),this.root=null),t},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=u},{"../../Runtime":1,"../../utils/PathUtils":89,"../Behavior":3,"../Status":10}],26:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("./Subtree"),s=function(t){function e(e){t.call(this,e),this.subtree=new r["default"]({name:this.name,getNotepad:e.getNotepad,onResult:e.onResult,blackboard:this.blackboard,emitter:this.emitter,assetPack:this.assetPack})}return n(e,t),e.prototype.start=function(){var t=this;return this.options.getFileName(function(e){t.subtree.behaviorPath=e,t.subtree._start()}),!0},e.prototype.stop=function(){this.subtree._stop()},e.prototype.update=function(){return this.subtree._update()},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Behavior":3,"./Subtree":25}],27:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../ParentBehavior"),r=t("../Status"),s=function(t){function e(e){t.call(this,e),this.current=-1}return n(e,t),e.prototype.start=function(){return 0===this.children.length?!1:(this.current=0,this.findStart())},e.prototype.findStart=function(){for(var t=!1;!t&&this.current<this.children.length;)t=this.children[this.current]._start(),t||this.current++;return!0},e.prototype.stop=function(){this.current=-1},e.prototype.update=function(){if(-1!==this.current&&this.current<this.children.length){var t=this.children[this.current]._update();return t===r["default"].FAILED?(this.current++,this.current>=this.children.length||!this.findStart()?r["default"].SUCCEEDED:r["default"].IN_PROGRESS):t===r["default"].PAUSED?r["default"].IN_PROGRESS:t}return r["default"].SUCCEEDED},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../ParentBehavior":9,"../Status":10}],28:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=t("../../Runtime"),a=function(t){function e(e){t.call(this,e,{noDistortion:!0}),this.status=r["default"].INVALID}return n(e,t),e.prototype.onPhoto=function(t,e){this.options.onPhoto(t,e),this.status=r["default"].SUCCEEDED},e.prototype.start=function(){var t=this;return this.status=r["default"].IN_PROGRESS,s["default"].instance.lps.takePhoto(this.options.resolution,this.options.noDistortion,s["default"].instance.lps.CameraID.LEFT,s["default"].instance.lps.PhotoType.FULL,function(e,i){return e?(t.onPhoto(e,null),void(t.status=r["default"].SUCCEEDED)):void t.onPhoto(null,i);
}),!0},e.prototype.update=function(){return this.status},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"../../Runtime":1,"../Behavior":3,"../Status":10}],29:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=t("../../Runtime"),a=function(t){function e(e){t.call(this,e),this.onSpeakingStopped=this.onSpeakingStopped.bind(this),this.status=r["default"].INVALID}return n(e,t),e.prototype.onSpeakingStopped=function(){this.status=r["default"].SUCCEEDED},Object.defineProperty(e.prototype,"words",{set:function(t){this.options.words=t},enumerable:!0,configurable:!0}),e.prototype.start=function(){var t=this,e=s["default"].instance.tts;return this.status=r["default"].IN_PROGRESS,e.speak(this.options.words,function(e){t.status=r["default"].SUCCEEDED,e&&console.log("tts.speak() error: "+e)}),this.cleanup(),e.on("word",this.options.onWord),e.on("stopped",this.onSpeakingStopped),!0},e.prototype.cleanup=function(){var t=s["default"].instance.tts;t.removeListener("stopped",this.onSpeakingStopped),t.removeListener("word",this.options.onWord)},e.prototype.stop=function(){this.cleanup()},e.prototype.update=function(){return this.status!==r["default"].IN_PROGRESS&&this.cleanup(),this.status},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"../../Runtime":1,"../Behavior":3,"../Status":10}],30:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("./TextToSpeech"),s=function(t){function e(e){t.call(this,e),this.behavior=new r["default"]({emitter:this.emitter,blackboard:this.blackboard,onWord:this.options.onWord,assetPack:this.assetPack})}return n(e,t),e.prototype.start=function(){var t=this;return this.options.getWords(function(e){t.behavior.words=e,t.behavior._start()}),!0},e.prototype.stop=function(){this.behavior._stop()},e.prototype.update=function(){return this.behavior._update()},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Behavior":3,"./TextToSpeech":29}],31:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Behavior"),r=t("../Status"),s=t("./Null"),a=t("../decorators/TimeoutSucceedJs"),u=function(t){function e(e){t.call(this,e);var i=new a["default"]({getTime:e.getTime});this.behavior=new s["default"]({decorators:[i]}),this.status=r["default"].INVALID}return n(e,t),e.prototype.start=function(){return this.status=r["default"].IN_PROGRESS,this.behavior._start()},e.prototype.stop=function(){this.behavior._stop()},e.prototype.update=function(){return this.status=this.behavior._update(),this.status},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=u},{"../Behavior":3,"../Status":10,"../decorators/TimeoutSucceedJs":45,"./Null":18}],32:[function(t,e,i){"use strict";var n=t("./Blink"),o=t("./ExecuteScript"),r=t("./ExecuteScriptAsync"),s=t("./Listen"),a=t("./ListenEmbedded"),u=t("./ListenJs"),c=t("./LookAt"),l=t("./Null"),p=t("./Parallel"),h=t("./PlayAnimation"),d=t("./PlayAudio"),f=t("./Random"),v=t("./ReadBarcode"),y=t("./Sequence"),_=t("./Subtree"),S=t("./SubtreeJs"),m=t("./Switch"),b=t("./TakePhoto"),g=t("./TextToSpeech"),P=t("./TextToSpeechJs"),E=t("./TimeoutJs");Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={Blink:n["default"],ExecuteScript:o["default"],ExecuteScriptAsync:r["default"],Listen:s["default"],ListenEmbedded:a["default"],ListenJs:u["default"],LookAt:c["default"],Null:l["default"],Parallel:p["default"],PlayAnimation:h["default"],PlayAudio:d["default"],Random:f["default"],ReadBarcode:v["default"],Sequence:y["default"],Subtree:_["default"],SubtreeJs:S["default"],Switch:m["default"],TakePhoto:b["default"],TextToSpeech:g["default"],TextToSpeechJs:P["default"],TimeoutJs:E["default"]}},{"./Blink":11,"./ExecuteScript":12,"./ExecuteScriptAsync":13,"./Listen":14,"./ListenEmbedded":15,"./ListenJs":16,"./LookAt":17,"./Null":18,"./Parallel":19,"./PlayAnimation":20,"./PlayAudio":21,"./Random":22,"./ReadBarcode":23,"./Sequence":24,"./Subtree":25,"./SubtreeJs":26,"./Switch":27,"./TakePhoto":28,"./TextToSpeech":29,"./TextToSpeechJs":30,"./TimeoutJs":31}],33:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.start=function(){return this.options.conditional()},e.prototype.update=function(t){return t},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r},{"../Decorator":7}],34:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=function(t){function e(e){t.call(this,e,{init:function(){}})}return n(e,t),e.prototype.start=function(){return this.options.init(),!this.options.conditional()},e.prototype.update=function(t){return this.options.conditional()?r["default"].FAILED:t},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Decorator":7,"../Status":10}],35:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=t("../../Runtime"),a=function(t){function e(e){t.call(this,e),this.didStart=!1,this._onEvent=this._onEvent.bind(this)}return n(e,t),e.prototype.start=function(){return this.didStart=!1,0!==this.options.eventName.length&&s["default"].instance.behaviorEmitter.on(this.options.eventName,this._onEvent),r["default"].WAIT},e.prototype._onEvent=function(t,e){this.options.onReceived&&this.options.onReceived(t,e),this.didStart=!0,s["default"].instance.behaviorEmitter.removeListener(this.options.eventName,this._onEvent)},e.prototype.stop=function(){0!==this.options.eventName.length&&s["default"].instance.behaviorEmitter.removeListener(this.options.eventName,this._onEvent)},e.prototype.update=function(t){return this.didStart?t:r["default"].WAIT},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"../../Runtime":1,"../Decorator":7,"../Status":10}],36:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=function(t){function e(e){t.call(this,e,{init:function(){}}),this.didStart=!1}return n(e,t),e.prototype.start=function(){return this.options.init(),this.didStart=!1,this.options.conditional()?(this.didStart=!0,!0):r["default"].WAIT},e.prototype.update=function(t){return this.didStart?t:this.options.conditional()?(this.didStart=!0,!0):r["default"].WAIT},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Decorator":7,"../Status":10}],37:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=function(t){function e(e){t.call(this,e),this._onEvent=this._onEvent.bind(this)}return n(e,t),e.prototype.start=function(){return this.emitter.once(this.options.eventName,this._onEvent),this.didStart=!1,r["default"].WAIT},e.prototype._onEvent=function(){this.options.onEvent.apply(null,arguments),this.didStart=!0},e.prototype.stop=function(){this.emitter.removeListener(this.options.eventName,this._onEvent)},e.prototype.update=function(t){return this.didStart?t:r["default"].WAIT},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Decorator":7,"../Status":10}],38:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=function(t){function e(e){t.call(this,e,{init:function(){}})}return n(e,t),e.prototype.start=function(){return this.options.init(),!0},e.prototype.update=function(t){return this.options.conditional()?r["default"].SUCCEEDED:t},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Decorator":7,"../Status":10}],39:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=t("../../Runtime"),a=function(t){function e(e){t.call(this,e),this.status=r["default"].INVALID}return n(e,t),e.prototype.start=function(){var t=this;this.status=r["default"].IN_PROGRESS;var e=s["default"].instance.asr;if(!e.isInitialized)return console.warn("Running listen without ASR service"),!0;var i={};return i.embeddedOnly=!0,this.listener=e.createListener(i,this.options.rule),this.listener.start(),this.listener.on("embedded",function(e,i){t.emitter.emit("hey-jibo",e,i),t.listener.removeAllListeners(),t.emitter.removeAllListeners(),t.status=r["default"].SUCCEEDED}),this.listener.on("error",function(e){t.emitter.emit("error",e)}),this.listener.on("finished",function(){t.listener.removeAllListeners(),t.emitter.removeAllListeners(),t.status=r["default"].SUCCEEDED}),this.options.onResult(this.emitter),this.status=r["default"].IN_PROGRESS,!0},e.prototype.stop=function(){this.emitter.removeAllListeners(),this.listener.removeAllListeners()},e.prototype.update=function(t){return this.status===r["default"].IN_PROGRESS?t:this.status},e}(o["default"]);a.Rules={HEY_jibo:"hey_jibo"},Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"../../Runtime":1,"../Decorator":7,"../Status":10}],40:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=function(t){function e(e){t.call(this,e),this._onEvent=this._onEvent.bind(this),this.status=r["default"].INVALID}return n(e,t),e.prototype.start=function(){return this.emitter.once(this.options.eventName,this._onEvent),this.status=r["default"].IN_PROGRESS,!0},e.prototype.stop=function(){this.emitter.removeListener(this.options.eventName,this._onEvent)},e.prototype._onEvent=function(){this.options.onEvent.apply(null,arguments),this.status=r["default"].SUCCEEDED},e.prototype.update=function(t){return this.status===r["default"].SUCCEEDED?r["default"].SUCCEEDED:t},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Decorator":7,"../Status":10}],41:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=t("./SucceedOnListenJs"),a=t("../../utils/PathUtils"),u=t("fs"),c=function(t){function e(e){t.call(this,e),this.status=r["default"].INVALID,this.options.rule=a["default"].setDefaultPath("rules",e.rule)}return n(e,t),e.prototype.start=function(){var t=this;this.status=r["default"].IN_PROGRESS;var e=function(e){a["default"].getAssetUri(t.options.rule,t.assetPack,function(t){u.readFile(t,"utf8",function(i,n){i&&console.error("Rule file does not exist: "+t),e(n)})})};return this.decorator=new s["default"]({getOptions:this.options.getOptions,getRule:e,onResult:this.options.onResult,emitter:this.emitter,blackboard:this.blackboard,assetPack:this.assetPack}),this.decorator._start()},e.prototype.stop=function(){this.decorator&&this.decorator._stop(),this.decorator=void 0},e.prototype.update=function(t){if(this.decorator){var e=this.decorator._update(t);return e===r["default"].SUCCEEDED&&(this.decorator=void 0),e}return this.status},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=c},{"../../utils/PathUtils":89,"../Decorator":7,"../Status":10,"./SucceedOnListenJs":42,fs:void 0}],42:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=t("events"),a=t("../../Runtime"),u=function(t){function e(e){t.call(this,e),this.status=r["default"].INVALID}return n(e,t),e.prototype.start=function(){var t=this;this.starting=!0;var e=this.options.getOptions(),i=a["default"].instance.asr;return this.status=r["default"].IN_PROGRESS,i.isInitialized?(this.emitter=new s.EventEmitter,this.options.getRule(function(n){t.listener=i.createListener(e,n),t.listener.start(),t.listener.on("cloud",function(e,i){t.emitter.emit("cloud",e,i)}),t.listener.on("incremental",function(e){t.emitter.emit("incremental",e,function(){t.listener.stop()})}),t.listener.on("embedded",function(e,i){t.emitter.emit("hey-jibo",e,i)}),t.listener.on("end",function(){t.emitter.emit("end")}),t.listener.on("error",function(e){t.emitter.emit("error",e)}),t.listener.on("finished",function(){t.listener.removeAllListeners(),t.emitter.removeAllListeners(),t.status=r["default"].SUCCEEDED}),t.options.onResult(t.emitter),t.status=r["default"].IN_PROGRESS,t.starting=!1}),!0):(console.warn("Running listen without ASR service"),!0)},e.prototype.stop=function(){this.starting||(this.emitter&&(this.emitter.removeAllListeners(),this.emitter=void 0),this.listener&&(this.listener.removeAllListeners(),this.listener.action.stop(),this.listener.action.clear(),this.listener=void 0))},e.prototype.update=function(t){return this.status===r["default"].IN_PROGRESS?t:this.status},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=u},{"../../Runtime":1,"../Decorator":7,"../Status":10,events:void 0}],43:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.start=function(){return this.startTime=(new Date).getTime(),!0},e.prototype.update=function(t){var e=(new Date).getTime()-this.startTime;return e>this.options.timeout?(this.behavior._stop(),r["default"].FAILED):t},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Decorator":7,"../Status":10}],44:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.start=function(){return this.startTime=(new Date).getTime(),!0},e.prototype.update=function(t){var e=(new Date).getTime()-this.startTime;return e>this.options.timeout?r["default"].SUCCEEDED:t},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Decorator":7,"../Status":10}],45:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.start=function(){return this.startTime=(new Date).getTime(),this.timeout=this.options.getTime(),!0},e.prototype.update=function(t){var e=(new Date).getTime()-this.startTime;return e>this.timeout?r["default"].SUCCEEDED:t},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Decorator":7,"../Status":10}],46:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("../Decorator"),r=t("../Status"),s=function(t){function e(e){t.call(this,e,{init:function(){}}),this.doInit=!0}return n(e,t),e.prototype.start=function(){return this.doInit&&(this.options.init(),this.doInit=!1),!0},e.prototype.update=function(t){return t===r["default"].SUCCEEDED&&this.options.conditional()?this.behavior._start()?r["default"].IN_PROGRESS:r["default"].FAILED:(this.doInit=t!==r["default"].IN_PROGRESS,t)},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../Decorator":7,"../Status":10}],47:[function(t,e,i){"use strict";var n=t("./Case"),o=t("./FailOnCondition"),r=t("./StartOnAnimEvent"),s=t("./StartOnCondition"),a=t("./StartOnEvent"),u=t("./SucceedOnCondition"),c=t("./SucceedOnEmbedded"),l=t("./SucceedOnEvent"),p=t("./SucceedOnListen"),h=t("./SucceedOnListenJs"),d=t("./TimeoutFail"),f=t("./TimeoutSucceed"),v=t("./TimeoutSucceedJs"),y=t("./WhileCondition");Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={Case:n["default"],FailOnCondition:o["default"],StartOnAnimEvent:r["default"],StartOnCondition:s["default"],StartOnEvent:a["default"],SucceedOnCondition:u["default"],SucceedOnEmbedded:c["default"],SucceedOnEvent:l["default"],SucceedOnListen:p["default"],SucceedOnListenJs:h["default"],TimeoutFail:d["default"],TimeoutSucceed:f["default"],TimeoutSucceedJs:v["default"],WhileCondition:y["default"]}},{"./Case":33,"./FailOnCondition":34,"./StartOnAnimEvent":35,"./StartOnCondition":36,"./StartOnEvent":37,"./SucceedOnCondition":38,"./SucceedOnEmbedded":39,"./SucceedOnEvent":40,"./SucceedOnListen":41,"./SucceedOnListenJs":42,"./TimeoutFail":43,"./TimeoutSucceed":44,"./TimeoutSucceedJs":45,"./WhileCondition":46}],48:[function(t,e,i){"use strict";var n=t("./Status"),o=t("./Factory"),r=t("./Blackboard"),s=t("./BehaviorTree"),a=t("./BehaviorEmitter"),u=t("./Behavior"),c=t("./ParentBehavior"),l=t("./BaseElement"),p=t("./Decorator"),h=t("./behaviors"),d=t("./decorators");Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={behaviors:h["default"],decorators:d["default"],Status:n["default"],Factory:o["default"],Blackboard:r["default"],BehaviorTree:s["default"],BehaviorEmitter:a["default"],Behavior:u["default"],BaseElement:l["default"],ParentBehavior:c["default"],Decorator:p["default"]}},{"./BaseElement":2,"./Behavior":3,"./BehaviorEmitter":4,"./BehaviorTree":5,"./Blackboard":6,"./Decorator":7,"./Factory":8,"./ParentBehavior":9,"./Status":10,"./behaviors":32,"./decorators":47}],49:[function(t,e,i){"use strict";function n(t){function e(t){t=Object.assign({constructor:function(){},start:function(){return!0},update:function(){this.status},stop:function(){}},t);var e=function(e){function i(i){e.call(this);for(var n in t)"constructor"!=n&&"function"==typeof t[n]&&(this[n]=t[n]);t.constructor.call(this,i)}return o(i,e),i}(a);return e}function i(t){t=Object.assign({constructor:function(){},start:function(){return!0},update:function(t){return t},stop:function(){}},t);var e=function(e){function i(i){e.call(this);for(var n in t)"constructor"!=n&&"name"!=n&&"namespace"!=n&&(this[n]=t[n]);t.constructor.call(this,i)}return o(i,e),i}(u);return e}var n=t.bt.Factory,a=t.bt.Behavior,u=t.bt.Decorator,c=t.FaceRenderer;GLOBAL.JIBO={},Object.defineProperty(GLOBAL.JIBO,"bt",{get:function(){return t.bt}}),Object.defineProperties(t.utils,{SerialTimer:{get:function(){return t.utils.perf.SerialTimer}},ParallelTimer:{get:function(){return t.utils.perf.ParallelTimer}}}),Object.defineProperties(t.services,{TtsService:{get:function(){return t.services.TTSService}},NluService:{get:function(){return t.services.NLUService}},NonMotionBodyService:{get:function(){return t.services.BodyService}},LpsService:{get:function(){return t.services.LPSService}}}),Object.defineProperties(t.services.asr,{AsrService:{get:function(){return t.services.asr.ASRService}}}),Object.defineProperty(t.Runtime.prototype,"bodySettings",{get:function(){return this.body}}),Object.defineProperty(n.prototype,"factory",{get:function(){return this}}),n.prototype.addBehavior=function(t,e){e=e||"";var i=s(r.parse(t.filename).name);this.register(i,e,t.exports)},n.prototype.createBehavior=function(t){return e(t)},n.prototype.createDecorator=function(t){return i(t)},n.prototype.registerBehavior=function(t){var i=t.name,n=t.namespace,o=e(t);return this.register(i,n,o),o},n.prototype.registerDecorator=function(t){var e=t.name,n=t.namespace,o=i(t);return this.register(e,n,o),o},a.prototype.setDecorators=function(t){return this.decorators=t,this},a.prototype.getName=function(){return this.name},a.prototype.setChildren=function(t){this.children=t},t.services.LPSService.prototype.getMotionData=function(){return this.lps.motionData},c.prototype.setRenderOnlyWhenDirty=function(t){this.renderOnlyWhenDirty=t},Object.defineProperty(c.prototype,"scene",{get:function(){var t=this;return{stop:function(){t.paused=!0},play:function(){t.paused=!1}}}});var l=t.utils.PathUtils,p=t.sound.SoundUtils;t.utils.AudioUtils={getPath:function(t){return l.setDefaultPath("audio",t)},startAudio:function(t,e,i){return l.getAudioUri(t,e,function(t){p.playOnce(t,i)}),t}}}var o=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},r=t("path"),s=t("pascal-case");Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n},{"pascal-case":void 0,path:void 0}],50:[function(t,e,i){"use strict";var n=t("./bt"),o=t("./services"),r=t("./utils"),s=t("./sound"),a=t("./Runtime"),u=t("./rendering/FaceRenderer"),c=t("./deprecation"),l=t("ws-without-native");if(GLOBAL.WebSocket=l,Object.assign||(Object.assign=t("object-assign")),!GLOBAL.jibo){var p={bt:n["default"],services:o["default"],utils:r["default"],sound:s["default"],Runtime:a["default"],FaceRenderer:u["default"]};c["default"](p),GLOBAL.jibo=new a["default"](p)}Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=GLOBAL.jibo},{"./Runtime":1,"./bt":48,"./deprecation":49,"./rendering/FaceRenderer":58,"./services":78,"./sound":85,"./utils":91,"object-assign":void 0,"ws-without-native":void 0}],51:[function(t,e,i){"use strict";var n=t("./EyeMesh"),o=t("path"),r=function(){function t(t,e){this.renderer=t,this.cache=e;var i=document.createElement("canvas");i.width=1,i.height=1,this._emptyTexture=PIXI.Texture.fromCanvas(i),this.stage=new PIXI.Container,this.filter=new PIXI.filters.ColorMatrixFilter,this.filter.reset(),this.cache=e,this.stage.filters=[this.filter],this.x=0,this.y=0,this.eyeMesh=new n["default"](this._emptyTexture),this.stage.addChild(this.eyeMesh),this.visible=!0,this.connected=!0}return Object.defineProperty(t.prototype,"visible",{get:function(){return this.eyeMesh.visible},set:function(t){this.eyeMesh.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texture",{set:function(t){var e=this;if(this._texture&&(this._texture.removeAllListeners("loaded"),this._texture.removeAllListeners("error")),0===o.extname(t).length)return void(this.visible=!1);if(this.cache)this._texture=PIXI.Texture.fromImage(t);else{var i=new Image;i.src=t;var n=new PIXI.BaseTexture(i);n.imageUrl=t,this._texture=new PIXI.Texture(n)}this._texture.baseTexture.on("loaded",function(){e.visible=!0,e.eyeMesh.texture=e._texture}),this._texture.baseTexture.on("error",function(){e.eyeMesh.texture=e._emptyTexture}),this._texture.baseTexture.hasLoaded?(this.visible=!0,this.eyeMesh.texture=this._texture):this._texture.baseTexture.isLoading||(this.eyeMesh.texture=this._emptyTexture)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{set:function(t){this.eyeMesh.rotation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{set:function(t){this.stage.x=t+this.renderer.width/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{set:function(t){this.stage.y=t+this.renderer.height/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"red",{set:function(t){this.filter.matrix[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"green",{set:function(t){this.filter.matrix[6]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blue",{set:function(t){this.filter.matrix[12]=t},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.renderer=null,this.stage=null,this.filter=null,this.eyeMesh=null},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r},{"./EyeMesh":56,path:void 0}],52:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=function(t){function e(e,i){t.call(this),this.cache=i,this.renderer=e,this.filter=new PIXI.filters.ColorMatrixFilter,this.filter.reset(),this.connected=!0}return n(e,t),Object.defineProperty(e.prototype,"red",{set:function(t){this.filter.matrix[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"green",{set:function(t){this.filter.matrix[6]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blue",{set:function(t){this.filter.matrix[12]=t},enumerable:!0,configurable:!0}),e.prototype.update=function(t,e){if(this.connected){if(e.screenBGTextureInfixBn_r&&e.screenBGTextureInfixBn_r!==this.texturePrev)if(this.texturePrev=e.screenBGTextureInfixBn_r,this.cache)this.texture=PIXI.Texture.fromImage(this.texturePrev);else{var i=new Image;i.src=this.texturePrev;var n=new PIXI.BaseTexture(i);n.imageUrl=this.texturePrev,this.texture=new PIXI.Texture(new PIXI.BaseTexture(i))}1===e.screenBG_redChannelBn_r&&1===e.screenBG_greenChannelBn_r&&1===e.screenBG_blueChannelBn_r?this.filters=null:(this.filters&&0!==this.filters.length||(this.filters=[this.filter]),this.red=e.screenBG_redChannelBn_r,this.green=e.screenBG_greenChannelBn_r,this.blue=e.screenBG_blueChannelBn_r)}},e}(PIXI.Sprite);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=o},{}],53:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=function(t){function e(e,i){t.call(this,e,i)}return n(e,t),e}(PIXI.Point);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=o},{}],54:[function(t,e,i){"use strict";function n(t,e){return t&&e?t.eyeSubRootBn_t===e.eyeSubRootBn_t&&t.eyeSubRootBn_t_2===e.eyeSubRootBn_t_2&&t.vertexJoint1_t===e.vertexJoint1_t&&t.vertexJoint1_t_2===e.vertexJoint1_t_2&&t.vertexJoint2_t===e.vertexJoint2_t&&t.vertexJoint2_t_2===e.vertexJoint2_t_2&&t.vertexJoint3_t===e.vertexJoint3_t&&t.vertexJoint3_t_2===e.vertexJoint3_t_2&&t.vertexJoint4_t===e.vertexJoint4_t&&t.vertexJoint4_t_2===e.vertexJoint4_t_2&&t.vertexJoint5_t===e.vertexJoint5_t&&t.vertexJoint5_t_2===e.vertexJoint5_t_2&&t.vertexJoint6_t===e.vertexJoint6_t&&t.vertexJoint6_t_2===e.vertexJoint6_t_2&&t.vertexJoint7_t===e.vertexJoint7_t&&t.vertexJoint7_t_2===e.vertexJoint7_t_2&&t.vertexJoint8_t===e.vertexJoint8_t&&t.vertexJoint8_t_2===e.vertexJoint8_t_2&&t.vertexJoint9_t===e.vertexJoint9_t&&t.vertexJoint9_t_2===e.vertexJoint9_t_2&&t.eye_redChannelBn_r===e.eye_redChannelBn_r&&t.eye_greenChannelBn_r===e.eye_greenChannelBn_r&&t.eye_blueChannelBn_r===e.eye_blueChannelBn_r&&t.eyeTextureInfixBn_r===e.eyeTextureInfixBn_r&&t.eyeSubRootBn_r===e.eyeSubRootBn_r&&t.overlay_textureSubRootBn_t===e.overlay_textureSubRootBn_t&&t.overlay_textureSubRootBn_t_2===e.overlay_textureSubRootBn_t_2&&t.overlay_textureSubRootBn_r===e.overlay_textureSubRootBn_r&&t.overlay_vertexJoint1_t===e.overlay_vertexJoint1_t&&t.overlay_vertexJoint1_t_2===e.overlay_vertexJoint1_t_2&&t.overlay_vertexJoint2_t===e.overlay_vertexJoint2_t&&t.overlay_vertexJoint2_t_2===e.overlay_vertexJoint2_t_2&&t.overlay_vertexJoint3_t===e.overlay_vertexJoint3_t&&t.overlay_vertexJoint3_t_2===e.overlay_vertexJoint3_t_2&&t.overlay_vertexJoint4_t===e.overlay_vertexJoint4_t&&t.overlay_vertexJoint4_t_2===e.overlay_vertexJoint4_t_2&&t.overlay_vertexJoint5_t===e.overlay_vertexJoint5_t&&t.overlay_vertexJoint5_t_2===e.overlay_vertexJoint5_t_2&&t.overlay_vertexJoint6_t===e.overlay_vertexJoint6_t&&t.overlay_vertexJoint6_t_2===e.overlay_vertexJoint6_t_2&&t.overlay_vertexJoint7_t===e.overlay_vertexJoint7_t&&t.overlay_vertexJoint7_t_2===e.overlay_vertexJoint7_t_2&&t.overlay_vertexJoint8_t===e.overlay_vertexJoint8_t&&t.overlay_vertexJoint8_t_2===e.overlay_vertexJoint8_t_2&&t.overlay_vertexJoint9_t===e.overlay_vertexJoint9_t&&t.overlay_vertexJoint9_t_2===e.overlay_vertexJoint9_t_2&&t.overlay_redChannelBn_r===e.overlay_redChannelBn_r&&t.overlay_greenChannelBn_r===e.overlay_greenChannelBn_r&&t.overlay_blueChannelBn_r===e.overlay_blueChannelBn_r&&t.overlayTextureInfixBn_r===e.overlayTextureInfixBn_r&&t.screenBGTextureInfixBn_r===e.screenBGTextureInfixBn_r&&t.screenBG_redChannelBn_r===e.screenBG_redChannelBn_r&&t.screenBG_greenChannelBn_r===e.screenBG_greenChannelBn_r&&t.screenBG_blueChannelBn_r===e.screenBG_blueChannelBn_r:!1}i.isNotDirty=n},{}],55:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./AbstractEye"),r=t("jibo-keyframes"),s=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.update=function(t,e){if(this.connected){var i=this.eyeMesh.dofs;e.eyeTextureInfixBn_r!==this.texturePrev&&(this.texturePrev=e.eyeTextureInfixBn_r,this.texture=this.texturePrev),i[0].x=r.conversion.toPixelsX(e.vertexJoint1_t),i[0].y=r.conversion.toPixelsY(e.vertexJoint1_t_2),i[1].x=r.conversion.toPixelsX(e.vertexJoint2_t),i[1].y=r.conversion.toPixelsY(e.vertexJoint2_t_2),i[2].x=r.conversion.toPixelsX(e.vertexJoint3_t),i[2].y=r.conversion.toPixelsY(e.vertexJoint3_t_2),i[3].x=r.conversion.toPixelsX(e.vertexJoint4_t),i[3].y=r.conversion.toPixelsY(e.vertexJoint4_t_2),i[4].x=r.conversion.toPixelsX(e.vertexJoint5_t),i[4].y=r.conversion.toPixelsY(e.vertexJoint5_t_2),i[5].x=r.conversion.toPixelsX(e.vertexJoint6_t),i[5].y=r.conversion.toPixelsY(e.vertexJoint6_t_2),i[6].x=r.conversion.toPixelsX(e.vertexJoint7_t),i[6].y=r.conversion.toPixelsY(e.vertexJoint7_t_2),i[7].x=r.conversion.toPixelsX(e.vertexJoint8_t),i[7].y=r.conversion.toPixelsY(e.vertexJoint8_t_2),i[8].x=r.conversion.toPixelsX(e.vertexJoint9_t),i[8].y=r.conversion.toPixelsY(e.vertexJoint9_t_2),this.x=r.conversion.toPixelsX(e.eyeSubRootBn_t),this.y=-r.conversion.toPixelsX(e.eyeSubRootBn_t_2),this.red=e.eye_redChannelBn_r,this.green=e.eye_greenChannelBn_r,this.blue=e.eye_blueChannelBn_r,this.rotation=-e.eyeSubRootBn_r}},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"./AbstractEye":51,"jibo-keyframes":void 0}],56:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./DOF"),r=function(t){function e(e){t.call(this,e,null,null,null,PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES),this.uvs=new Float32Array([0,0,.5,0,1,0,0,.5,.5,.5,1,.5,0,1,.5,1,1,1]),this.vertices=new Float32Array(2*this.uvs.length),this.dofs=[];for(var i=0;i<this.uvs.length;i+=2)this.dofs.push(new o["default"](this.uvs[i],this.uvs[i+1]));
this.indices=new Uint16Array([0,1,3,1,3,4,1,4,5,2,5,1,3,4,7,7,6,3,4,5,7,5,7,8])}return n(e,t),e.prototype.updateTransform=function(){for(var t=0;t<this.dofs.length;t++){var e=this.dofs[t],i=2*t;this.vertices[i]=e.x,this.vertices[i+1]=e.y}this.containerUpdateTransform()},e}(PIXI.mesh.Mesh);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r},{"./DOF":53}],57:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./AbstractEye"),r=t("jibo-keyframes"),s=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.update=function(t,e){if(this.connected){var i=this.eyeMesh.dofs;e.eyeTextureInfixBn_r!==this.texturePrev&&(this.texturePrev=e.overlayTextureInfixBn_r,this.texture=this.texturePrev),i[0].x=r.conversion.toPixelsX(e.overlay_vertexJoint1_t),i[0].y=r.conversion.toPixelsY(e.overlay_vertexJoint1_t_2),i[1].x=r.conversion.toPixelsX(e.overlay_vertexJoint2_t),i[1].y=r.conversion.toPixelsY(e.overlay_vertexJoint2_t_2),i[2].x=r.conversion.toPixelsX(e.overlay_vertexJoint3_t),i[2].y=r.conversion.toPixelsY(e.overlay_vertexJoint3_t_2),i[3].x=r.conversion.toPixelsX(e.overlay_vertexJoint4_t),i[3].y=r.conversion.toPixelsY(e.overlay_vertexJoint4_t_2),i[4].x=r.conversion.toPixelsX(e.overlay_vertexJoint5_t),i[4].y=r.conversion.toPixelsY(e.overlay_vertexJoint5_t_2),i[5].x=r.conversion.toPixelsX(e.overlay_vertexJoint6_t),i[5].y=r.conversion.toPixelsY(e.overlay_vertexJoint6_t_2),i[6].x=r.conversion.toPixelsX(e.overlay_vertexJoint7_t),i[6].y=r.conversion.toPixelsY(e.overlay_vertexJoint7_t_2),i[7].x=r.conversion.toPixelsX(e.overlay_vertexJoint8_t),i[7].y=r.conversion.toPixelsY(e.overlay_vertexJoint8_t_2),i[8].x=r.conversion.toPixelsX(e.overlay_vertexJoint9_t),i[8].y=r.conversion.toPixelsY(e.overlay_vertexJoint9_t_2),this.x=r.conversion.toPixelsX(e.overlay_textureSubRootBn_t),this.y=-r.conversion.toPixelsX(e.overlay_textureSubRootBn_t_2),this.red=e.overlay_redChannelBn_r,this.green=e.overlay_greenChannelBn_r,this.blue=e.overlay_blueChannelBn_r,this.rotation=-e.overlay_textureSubRootBn_r}},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"./AbstractEye":51,"jibo-keyframes":void 0}],58:[function(t,e,i){"use strict";GLOBAL.PIXI||t("pixi-animate/dist/pixi-animate");var n=t("./Background"),o=t("./Eye"),r=t("./EyeOverlay"),s=t("./DOFValues"),a=function(){function t(t,e){void 0===e&&(e=!0),this.cache=e,this.stage=new PIXI.Container,this.root=new PIXI.Container,this.backgroundBorder=new PIXI.Graphics,this.root.addChild(this.stage),this._renderOnlyWhenDirty=!0,this._zoom=1,this.update=this.update.bind(this),this._paused=!0,this._timer=t,this.connected=!0,this._timer.on("update",this.update)}return Object.defineProperty(t.prototype,"renderOnlyWhenDirty",{set:function(t){this._renderOnlyWhenDirty=t},enumerable:!0,configurable:!0}),t.prototype.init=function(e){var i=document.createElement("canvas");i.style.width="100%",i.style.height="100%",this.canvas=i,e.appendChild(i),this.renderer=new PIXI.WebGLRenderer(t.WIDTH,t.HEIGHT,{view:i,backgroundColor:0,antialias:!0}),this.eye=new o["default"](this.renderer,this.cache),this.eyeOverlay=new r["default"](this.renderer,this.cache),this.background=new n["default"](this.renderer,this.cache),this.stage.addChild(this.background),this.stage.addChild(this.backgroundBorder),this.stage.addChild(this.eye.stage),this.stage.addChild(this.eyeOverlay.stage),this.paused=!1},t.prototype.display=function(t,e){this._previousDofValues=this._currentDofValues,this._currentDofValues=e,this.connected&&(this.eye.update(t,e),this.eyeOverlay.update(t,e),this.background.update(t,e))},Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t,this.background.visible=t,this.eye.visible=t,this.eyeOverlay.visible=t},enumerable:!0,configurable:!0}),t.prototype.update=function(t){this._paused||(this._renderOnlyWhenDirty?s.isNotDirty(this._previousDofValues,this._currentDofValues)||this.renderer.render(this.root):this.renderer.render(this.root))},Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){t!==this._paused&&(this._paused=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoom",{get:function(){return this._zoom},set:function(e){this._zoom=e,e=Math.min(e,1),this.stage.scale.x=e,this.stage.scale.y=e,this.stage.x=.5*(t.WIDTH-e*t.WIDTH),this.stage.y=.5*(t.HEIGHT-e*t.HEIGHT)},enumerable:!0,configurable:!0}),t.prototype.makeBorder=function(){this.backgroundBorder.lineStyle(3,16777215).moveTo(0,0).lineTo(t.WIDTH,0).lineTo(t.WIDTH,t.HEIGHT).lineTo(0,t.HEIGHT).lineTo(0,0)},t.prototype.destroy=function(){this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this._timer&&(this._timer.removeListener("update",this.update),this._timer=null),this._paused=!0,this.stage=null,this.eye.destroy(),this.eye=null,this.eyeOverlay.destroy(),this.eyeOverlay=null,this.background=null,this.backgroundBorder=null,this.root.destroy(!0),this.root=null,this.renderer.destroy()},t.WIDTH=1280,t.HEIGHT=720,t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"./Background":52,"./DOFValues":54,"./Eye":55,"./EyeOverlay":57,"pixi-animate/dist/pixi-animate":void 0}],59:[function(t,e,i){"use strict";var n=function(){function t(){this.httpInterface=void 0}return t.prototype.init=function(t,e){this.httpInterface="http://"+t.host+":"+t.port,e()},t.prototype.getMasterVolume=function(t){this._getMixerSetting(function(e,i){e?t(e):t(null,i.master.playbackVolume)})},t.prototype.setMasterVolume=function(t,e){var i=this;if(!t||0>t||t>1){var n="Master volume of "+t+" is out of range [0.0 - 1.0].";return void e(n)}this._getMixerSetting(function(n,o){if(n)e(n);else{var r=new XMLHttpRequest,s=i.httpInterface+"/mixer";r.open("POST",s,!0),r.onreadystatechange=function(){if(4==r.readyState)if(204==r.status)e(null);else{var t="Audio Service is unavailable";void 0!==r.statusText&&""!==r.statusText&&(t=r.statusText),e(t)}},o.master.playbackVolume=t,r.send(JSON.stringify(o))}})},t.prototype._getMixerSetting=function(t){if(void 0===this.httpInterface)return void t("Audio Service is not available",null);var e=new XMLHttpRequest;e.open("GET",this.httpInterface+"/mixer",!0),e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status)if(e.response){var i=JSON.parse(e.response);t(null,i)}else t("No data received from audio service",null);else{var n="Audio service is unavailable";void 0!==e.statusText&&""!==e.statusText&&(n=e.statusText),t(n,null)}},e.send()},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n},{}],60:[function(t,e,i){"use strict";var n=t("async"),o=function(){function t(){this.bs={},this.bs.miscState={ts:[],main_board_temp:0,cpu_temp:0,intake_temp:0,exhaust_temp:0,neck_motor_temp:0,torso_motor_temp:0,pelvis_motor_temp:0},this.bs.touchState={ts:[],touched:!1,pad_state:[0,0,0,0,0,0],changed:[0,0,0,0,0,0]},this.bs.powerState={ts:[],source:"",vsys:0,battery:{id:0,cycles:0,capacity:0,max_capacity:0,charge_rate:0,temp:0}}}return t.prototype.init=function(t,e){this.httpInterface="http://"+t.host+":"+t.port,this.socketUrl="ws:"+t.host+":"+t.port,n.parallel([this.createMiscSocket.bind(this),this.createTouchSocket.bind(this),this.createPowerSocket.bind(this)],e)},t.prototype.getBatteryTemperature=function(){return this.bs.powerState.battery.temp},t.prototype.getBatteryLevel=function(){return this.bs.powerState.battery.capacity/this.bs.powerState.battery.max_capacity*100},t.prototype.getSystemVoltage=function(){return this.bs.powerState.vsys},t.prototype.isBatteryCharging=function(){return"EXTERNAL"===this.bs.powerState.source},t.prototype.getMainBoardTemperature=function(){return this.bs.miscState.main_board_temp},t.prototype.getCPUTemperature=function(){return this.bs.miscState.cpu_temp},t.prototype.getTouchState=function(){return this.bs.touchState},t.prototype.getFanSpeed=function(t){this._getSystemSetting("fan_speed",t)},t.prototype.getBacklight=function(t){this._getSystemSetting("lcd_backlight",t)},t.prototype._getSystemSetting=function(t,e){if(void 0===this.httpInterface)return void e("Body Service is not available",null);var i=new XMLHttpRequest;i.open("GET",this.httpInterface+"/settings",!0),i.onreadystatechange=function(){if(4==i.readyState)if(200==i.status)if(i.response){var n=JSON.parse(i.response);e(null,n[t])}else e("No data received from body service",null);else{var o="Body service is unavailable";void 0!==i.statusText&&""!==i.statusText&&(o=i.statusText),e(o,null)}},i.send()},t.prototype.setBacklight=function(t,e){var i=this;if(0>t||t>1){var n="Backlight brightness value of "+t+" is out of range [0.0 - 1.0].";return void e(n)}this.getFanSpeed(function(n,o){if(n)e(n);else{var r={lcd_backlight:t,fan_speed:o},s=new XMLHttpRequest,a=i.httpInterface+"/settings";s.open("POST",a,!0),s.onreadystatechange=function(){if(4==s.readyState)if(204==s.status)e(null);else{var t="Body service is unavailable";void 0!==s.statusText&&""!==s.statusText&&(t=s.statusText),e(t,null)}},s.send(JSON.stringify(r))}})},t.prototype.createMiscSocket=function(t){var e=this;this.MiscSocket=new WebSocket(this.socketUrl+"/misc"),this.MiscSocket.onerror=function(){console.error("Error opening misc state socket at "+e.socketUrl+"/misc")},this.MiscSocket.onmessage=function(t){e.bs.miscState=JSON.parse(t.data)},t()},t.prototype.createTouchSocket=function(t){var e=this;this.TouchSocket=new WebSocket(this.socketUrl+"/touch"),this.TouchSocket.onerror=function(){console.error("Error opening touch state socket at "+e.socketUrl+"/touch")},this.TouchSocket.onmessage=function(t){e.bs.touchState=JSON.parse(t.data)},t()},t.prototype.createPowerSocket=function(t){var e=this;this.PowerSocket=new WebSocket(this.socketUrl+"/power"),this.PowerSocket.onerror=function(){console.error("Error opening power state socket at "+e.socketUrl+"/power")},this.PowerSocket.onmessage=function(t){e.bs.powerState=JSON.parse(t.data)},t()},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=o},{async:void 0}],61:[function(t,e,i){"use strict";var n=t("async"),o={DEBUG:0,PREVIEW:1,FULL:2},r={LEFT:0,RIGHT:1},s={SMALL:1,MEDIUM:2,LARGE:3,XLARGE:4},a=[{width:672,height:380},{width:1280,height:720},{width:1920,height:1080},{width:2688,height:1520}],u=function(){function t(){this.lps={},this.lps.motionData={cameras:[],entities:[]},this.lps.audioData={entities:[]},this.PhotoType=o,this.PhotoRes=s,this.CameraID=r}return Object.defineProperty(t.prototype,"motionData",{get:function(){return this.lps.motionData},enumerable:!0,configurable:!0}),t.prototype.getClosestVisualEntity=function(){var t;return void 0!==this.lps.motionData&&void 0!==this.lps.motionData.entities&&this.lps.motionData.entities.length>0&&(t=this.lps.motionData.entities[0]),t},t.prototype.getVisualEntityById=function(t){for(var e,i=0;i<this.lps.motionData.entities.length;i++){var n=this.lps.motionData.entities[i];if(n&&n.id===t){e=n;break}}return e},t.prototype.getClosestAudibleEntity=function(){var t;return void 0!==this.lps.audioData&&void 0!==this.lps.audioData.entities&&this.lps.audioData.entities.length>0&&(t=this.lps.audioData.entities[0]),t},t.prototype.getAudibleEntityById=function(t){for(var e,i=0;i<this.lps.audioData.entities.length;i++){var n=this.lps.audioData.entities[i];if(n&&n.id===t){e=n;break}}return e},t.prototype.getPreview=function(t){if(void 0===this.httpUrl)return void t("Preview service is not initialized",null);var e=new XMLHttpRequest;e.open("GET",this.httpUrl+"/media/preview/control",!0),e.onreadystatechange=function(){if(4==e.readyState)if(204==e.status)t();else{var i="Preview service unavailable";void 0!==e.statusText&&""!==e.statusText&&(i=e.statusText),t(i,null)}},e.send()},t.prototype.setPreview=function(t,e){if(void 0===this.httpUrl)return void e("Preview service is not initialized",null);var i={};if(!t.hasOwnProperty("enable"))return void e("Preview service data must have 'enable' property",null);t.hasOwnProperty("width")||(t.width=1280),t.hasOwnProperty("height")||(t.height=720),t.hasOwnProperty("x")||(t.x=0),t.hasOwnProperty("y")||(t.y=0),i.enable=t.enable,i.window={width:t.width,height:t.height,x:t.x,y:t.y};var n=new XMLHttpRequest;n.open("POST",this.httpUrl+"/media/preview/control",!0),n.onreadystatechange=function(){if(4==n.readyState)if(204==n.status)e();else{var t="Preview service unavailable";void 0!==n.statusText&&""!==n.statusText&&(t=n.statusText),e(t,null)}},n.send(JSON.stringify(i))},t.prototype.readBarcode=function(t){if(void 0===this.httpUrl)return void t("Barcode service is not initialized",null);var e=new XMLHttpRequest;e.open("GET",this.httpUrl+"/lps/barcode",!0),e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status)if(e.response){var i=JSON.parse(e.response);t(null,i.barcodes)}else t("No data received from barcode service",null);else{var n="Barcode service unavailable";void 0!==e.statusText&&""!==e.statusText&&(n=e.statusText),t(n,null)}},e.send()},t.prototype.takePhoto=function(t,e,i,n,o){var r=this;if(void 0===this.httpUrl)return void o("Photo service is not initialized",null);t!==this.PhotoRes.MEDIUM&&(t=this.PhotoRes.MEDIUM);var s=a[t-1].width,u=a[t-1].height;i!==this.CameraID.LEFT&&(i=this.CameraID.LEFT),(n<this.PhotoType.DEBUG||n>this.PhotoType.FULL)&&(n=this.PhotoType.FULL);var c={camera:i,width:s,height:u,type:n,undistort:e},l=this.httpUrl+"/media/photo",p=new XMLHttpRequest;p.open("POST",l,!0),p.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),p.setRequestHeader("Accept","*/*"),p.onreadystatechange=function(){if(4==p.readyState)if(200===p.status)if(p.response){var t=JSON.parse(p.response);r._getPhoto(t.id,o)}else o("No data received from photo service",null);else{var e="Photo service unavailable";void 0!==p.statusText&&""!==p.statusText&&(e=p.statusText),o(e,null)}},p.send(JSON.stringify(c))},t.prototype._getPhoto=function(t,e){var i=this.httpUrl+"/media/photo?id="+t;e(null,i)},t.prototype.init=function(t,e){this.lpsServiceUrl="ws:"+t.host+":"+t.port,this.httpUrl="http://"+t.host+":"+t.port,n.parallel([this._createMotionSocket.bind(this),this._createAudioSocket.bind(this)],e)},t.prototype._createMotionSocket=function(t){var e=this;this.motionSocket=new WebSocket(this.lpsServiceUrl+"/lps/visual_awareness"),this.motionSocket.onerror=function(){console.error("Error opening visual awareness socket at "+e.lpsServiceUrl+"/visual_awareness")},this.motionSocket.onmessage=function(t){e.lps.motionData=JSON.parse(t.data)},t()},t.prototype._createAudioSocket=function(t){var e=this;this.audioSocket=new WebSocket(this.lpsServiceUrl+"/lps/audible_awareness"),this.audioSocket.onerror=function(){console.error("Error opening audible awareness socket at "+e.lpsServiceUrl+"/audible_awareness")},this.audioSocket.onmessage=function(t){e.lps.audioData=JSON.parse(t.data)},t()},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=u},{async:void 0}],62:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("events"),r=function(t){function e(){t.call(this)}return n(e,t),e.prototype.init=function(t,e){this.httpInterface="http://"+t.host+":"+t.port,this.loggingEnabled=!1,e()},e.prototype.compile=function(t,e,i){var n=this,o={REQ_TYPE:"COMPILE",REQ_CONTENT:{RULE_STRING:t}};i&&(o.REQ_CONTENT.URI="handle:"+i);var r=new XMLHttpRequest;o=JSON.stringify(o),r.open("POST",this.httpInterface+"/nlu_interface",!0),r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var t=JSON.parse(r.response);if(n.loggingEnabled&&(console.log("request.response"),console.log(r.response)),"OK"===t.Status){var i=t.URI;e(null,i)}else"ERROR"===t.Status&&e(t.Message)}else 4==r.readyState&&0===r.status&&e("NLU Service is unavailable")},this.loggingEnabled&&(console.log("body"),console.log(o)),r.send(o)},e.prototype.parseFromRule=function(t,e,i,n){var o=this;e=e.toLowerCase();var r={REQ_TYPE:"PARSE_FROM_TEXT",REQ_CONTENT:{RULE_STRING:t,TXT_STRING:e},MESSAGE_ID:n},s=new XMLHttpRequest;r=JSON.stringify(r),s.open("POST",this.httpInterface+"/nlu_interface",!0),s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){var t=JSON.parse(s.response);if(o.loggingEnabled&&(console.log("request.response"),console.log(s.response)),"OK"===t.Status){var n=t.Result.length>0?t.Result[0]:{Input:e};i(null,n)}else"ERROR"===t.Status&&i(t.Message)}else 4==s.readyState&&0===s.status&&i("NLU Service is unavailable")},this.loggingEnabled&&(console.log("body"),console.log(r)),s.send(r)},e.prototype.parseFromURI=function(t,e,i,n){var o=this;e=e.toLowerCase();var r={REQ_TYPE:"PARSE_FROM_URI",REQ_CONTENT:{URI:t,TXT_STRING:e},MESSAGE_ID:n},s=new XMLHttpRequest;r=JSON.stringify(r),s.open("POST",this.httpInterface+"/nlu_interface",!0),s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){var t=JSON.parse(s.response);if(o.loggingEnabled&&(console.log("request.response"),console.log(s.response)),"OK"===t.Status){var n=t.Result.length>0?t.Result[0]:{Input:e};i(null,n)}else"ERROR"===t.Status&&i(t.Message)}else 4==s.readyState&&0===s.status&&i("NLU Service is unavailable")},this.loggingEnabled&&(console.log("body"),console.log(r)),s.send(r)},e.prototype.setLogging=function(t){this.loggingEnabled=t},e.prototype.parseFromFile=function(){},e}(o.EventEmitter);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r},{events:void 0}],63:[function(t,e,i){"use strict";var n=function(){function t(){this.token="abcdef"}return t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n},{}],64:[function(t,e,i){"use strict";function n(t,e){function i(t,e){for(var i=new Array(80),n=-1,o=0,r=t.length,s=0;64>s;s++){var a=0;r>s?a=t.charCodeAt(s):e&&(s==r?a=e>>>24&255:s==r+1?a=e>>>16&255:s==r+2?a=e>>>8&255:s==r+3?a=255&e:s==r+4&&(a=128)),0===o&&(n++,i[n]=0,o=32),o-=8,i[n]=i[n]|a<<o}return e&&(i[15]=8*(64+r+4)),i}function n(t,e){for(var i=e<<24|e<<16|e<<8|e,n=0;16>n;n++)t[n]^=i;for(var o,r=[1732584193,4023233417,2562383102,271733878,3285377520],s=r[0],a=r[1],u=r[2],c=r[3],l=r[4],p=16;80>p;p++)o=t[p-3]^t[p-8]^t[p-14]^t[p-16],t[p]=o<<1|o>>>31;for(var h=0;20>h;h++)o=(s<<5|s>>>27)+l+t[h]+1518500249+(a&u|~a&c),l=c,c=u,u=a<<30|a>>>2,a=s,s=4294967295&o;for(var d=20;40>d;d++)o=(s<<5|s>>>27)+l+t[d]+1859775393+(a^u^c),l=c,c=u,u=a<<30|a>>>2,a=s,s=4294967295&o;for(var f=40;60>f;f++)o=(s<<5|s>>>27)+l+t[f]+2400959708+(a&u|a&c|u&c),l=c,c=u,u=a<<30|a>>>2,a=s,s=4294967295&o;for(var v=60;80>v;v++)o=(s<<5|s>>>27)+l+t[v]+3395469782+(a^u^c),l=c,c=u,u=a<<30|a>>>2,a=s,s=4294967295&o;return r[0]=r[0]+s&4294967295,r[1]=r[1]+a&4294967295,r[2]=r[2]+u&4294967295,r[3]=r[3]+c&4294967295,r[4]=r[4]+l&4294967295,r}for(var o=n(i(t,0),54),r=n(i(t,0),92),s="",a=0;s.length<64;){var u=[0,0,0,0,0];a++;for(var c=i(e,a),l=0;8192>l;l++){for(var p=1&l?r:o,h=p[0],d=p[1],f=p[2],v=p[3],y=p[4],_=void 0,S=16;80>S;S++)_=c[S-3]^c[S-8]^c[S-14]^c[S-16],c[S]=_<<1|_>>>31;for(var m=0;20>m;m++)_=(h<<5|h>>>27)+y+c[m]+1518500249+(d&f|~d&v),y=v,v=f,f=d<<30|d>>>2,d=h,h=4294967295&_;for(var b=20;40>b;b++)_=(h<<5|h>>>27)+y+c[b]+1859775393+(d^f^v),y=v,v=f,f=d<<30|d>>>2,d=h,h=4294967295&_;for(var g=40;60>g;g++)_=(h<<5|h>>>27)+y+c[g]+2400959708+(d&f|d&v|f&v),y=v,v=f,f=d<<30|d>>>2,d=h,h=4294967295&_;for(var P=60;80>P;P++)_=(h<<5|h>>>27)+y+c[P]+3395469782+(d^f^v),y=v,v=f,f=d<<30|d>>>2,d=h,h=4294967295&_;if(c[0]=p[0]+h&4294967295,c[1]=p[1]+d&4294967295,c[2]=p[2]+f&4294967295,c[3]=p[3]+v&4294967295,c[4]=p[4]+y&4294967295,1&l)u[0]^=c[0],u[1]^=c[1],u[2]^=c[2],u[3]^=c[3],u[4]^=c[4];else if(0===l){c[5]=2147483648;for(var E=6;15>E;E++)c[E]=0;c[15]=672}}for(var O=0;5>O;O++)for(var R=0;8>R;R++){var w=u[O]>>>28-4*R&15;s+=10>w?w:String.fromCharCode(87+w)}}return s.substring(0,64)}var o=t("semver"),r=t("path"),s=t("../utils/PathUtils"),a=function(){function e(){}return e.prototype.init=function(e,i){this.httpInterface="http://"+e.host+":"+e.port,this.wifiInterface=this.httpInterface+"/wifi",this.loggingEnabled=!1,this.getVersion(function(e,n){return e?void i(e):void s["default"].getBaseDirectory(__dirname,function(e){var s,a=t(r.resolve(e,"package.json")).platform;o.satisfies(n,a)||(s="Platform version check failed! Skill allows version "+a+" but your current version is "+n+"."),i(s)})})},e.prototype.setLogging=function(t){this.loggingEnabled=t},e.prototype.wifiStatus=function(t){this._handleWifiRequest("STATUS-VERBOSE",t)},e.prototype.addNetwork=function(t){var e="ADD_NETWORK";this._handleWifiRequest(e,t)},e.prototype.setNetwork=function(t,e,i){var o=this,r=Object.keys(e);r.forEach(function(r){var s;"ssid"===r?(s='"'+e[r]+'"',o.ssid=e[r]):"password"===r&&e[r]?o.ssid?(s=n(e[r],o.ssid),r="psk"):i("No ssid to generate psk for WPA-PSK network"):s=e[r];var a="SET_NETWORK";a+=" "+t,a+=" "+r,a+=" "+s,o._handleWifiRequest(a,i)})},e.prototype.removeNetwork=function(t,e){this._handleWifiRequest("REMOVE_NETWORK "+t,e)},e.prototype.saveConfig=function(t){this._handleWifiRequest("SAVE_CONFIG",t)},e.prototype.listNetworks=function(t){this._handleWifiRequest("LIST_NETWORKS",t)},e.prototype.reassociate=function(t){this._handleWifiRequest("REASSOCIATE",t)},e.prototype.reconfigure=function(t){this._handleWifiRequest("RECONFIGURE",t)},e.prototype.disconnect=function(t){this._handleWifiRequest("DISCONNECT",t)},e.prototype.reconnect=function(t){this._handleWifiRequest("RECONNECT",t)},e.prototype.disableNetwork=function(t,e){this._handleWifiRequest("DISABLE_NETWORK "+t,e)},e.prototype.enableNetwork=function(t,e){this._handleWifiRequest("ENABLE_NETWORK "+t,e)},e.prototype.selectNetwork=function(t,e){this._handleWifiRequest("SELECT_NETWORK "+t,e)},e.prototype._handleWifiRequest=function(t,e){var i=this,n={command:t},o=new XMLHttpRequest;n=JSON.stringify(n),o.open("POST",this.wifiInterface,!0),o.onreadystatechange=function(){if(4==o.readyState)if(200==o.status){var t=JSON.parse(o.response);i.loggingEnabled&&(console.log("response"),console.log(t.response)),t=t.response,e(null,t)}else{var n="System Manager is unavailable";void 0!==o.statusText&&""!==o.statusText&&(n=o.statusText),e(n,null)}},this.loggingEnabled&&(console.log("body"),console.log(n)),o.send(n)},e.prototype.getVersion=function(t){this.getDisplayVersion(function(e,i){if(i){var n=i.trim().match("(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)");t(null,n[0])}else t("Could not retrieve platform version from "+i,null)})},e.prototype.getDisplayVersion=function(t){this._handleGET("/version","version",t)},e.prototype.getCredentials=function(t){this._handleGET("/credentials",void 0,t)},e.prototype.setCredentials=function(t,e){if(!t)return void e("No credentials given");var i=new XMLHttpRequest,n="";try{n=JSON.stringify(t)}catch(o){return void e("Credentials are not valid JSON")}i.open("POST",this.httpInterface+"/credentials",!0),i.onreadystatechange=function(){if(4==i.readyState)if(204==i.status)e();else{var t="System Manager is unavailable";void 0!==i.statusText&&""!==i.statusText&&(t=i.statusText),e(t,null)}},this.loggingEnabled&&(console.log("credentials requested"),console.log(n)),i.send(n)},e.prototype.checkForUpdates=function(t){this._handleGET("/update","updates",t)},e.prototype.downloadUpdates=function(t,e){if(!t||!t.hasOwnProperty("ids")||0===t.ids.length)return void e("No IDs given.");var i=new XMLHttpRequest;i.open("PUT",this.httpInterface+"/update",!0),i.previousText="",i.onreadystatechange=function(){if(i.readyState>2)if(200===i.status)if(i.responseText){var t=i.responseText.substring(i.previousText.length),n=t.lastIndexOf("}");if(-1!==n){n+=1;var o=t.lastIndexOf("{",n);t=t.substring(o,n);var r=JSON.parse(t);e(null,r)}i.previousText=i.responseText}else e("No data received from OTA service",null);else{var s="System Manager is unavailable";void 0!==i.statusText&&""!==i.statusText&&(s=i.statusText),e(s,null)}},this.getVersion(function(n,o){if(n)e("Cannot retrieve platform version to check compatibility. Download aborted.",null);else{var r={};r="0.12.1"===o?{id:t.ids[0]}:{ids:t.ids},i.send(JSON.stringify(r))}})},e.prototype._handleGET=function(t,e,i){var n=this,o=new XMLHttpRequest;o.open("GET",this.httpInterface+t,!0),o.onreadystatechange=function(){if(4==o.readyState)if(200==o.status){var t=JSON.parse(o.response),r=e?t[e]:t;n.loggingEnabled&&(console.log(e),console.log(r)),i(null,r)}else{var s="System Manager is unavailable";void 0!==o.statusText&&""!==o.statusText&&(s=o.statusText),i(s,null)}},o.send()},e.prototype.getIdentity=function(t){this._handleGET("/identity",void 0,function(e,i){e?t("Could not retrieve identity from Jibo",null):t(null,{name:i.name,wifi_mac:i.wifi_mac})})},e}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"../utils/PathUtils":89,path:void 0,semver:void 0}],65:[function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},o=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},r=t("async"),s=t("events"),a={SSML:"ssml",TEXT:"text"},u={TOKENS:"/tts_tokens",PHONES:"/tts_phones",STOP:"/tts_stop",SPEAK:"/tts_speak",TIMING:"/tts_token_times",EFFECTS:"/tts_effects",ANALYSIS:"/tts_analysis"},c={WORD:"word",PHONE:"phone",STOP:"stop",EFFECT:"effect",ANALYSIS:"analysis"},l={START:"START",STOP:"STOP",UPDATE:"UPDATE"},p={prompt:"",locale:"en-us",voice:"griffin",duration_stretch:1,pitch:1,pitchBandwidth:.55,mode:a.TEXT,outputMode:"stream"},h=function(t){function e(){t.call(this),this.isInitialized=!1,this.isTalking=!1,this.isStopping=!1,this.TTSEvents=c,this.TTSMode=a}return o(e,t),Object.defineProperty(e,"TTSMode",{get:function(){return a},enumerable:!0,configurable:!0}),Object.defineProperty(e,"TTSEvents",{get:function(){return c},enumerable:!0,configurable:!0}),e.prototype.init=function(t,e){var i=this;if(!t.host||"string"!=typeof t.host)throw new Error("Missing required service.host");this.httpInterface="http://"+t.host+":"+t.port,this.socketUrl="ws:"+t.host+":"+t.port;var n=function(t){var e=function(e){i.effectsSocket=e,t()};i.createSocket(u.EFFECTS,"tts sound effects",c.EFFECT)(e)};r.parallel([this.createSocket(u.TOKENS,"tts tokens",c.WORD).bind(this),this.createSocket(u.PHONES,"tts phones",c.PHONE).bind(this),this.createSocket(u.ANALYSIS,"tts analysis",c.ANALYSIS).bind(this),n],function(){i.isInitialized=!0,e()})},e.prototype.getOptionsAndCallback=function(t,e){var i,o={};return void 0===t&&void 0===e?o={}:"object"===("undefined"==typeof t?"undefined":n(t))&&void 0===e?o=t:"function"==typeof t&&void 0===e?i=t:"object"===("undefined"==typeof t?"undefined":n(t))&&"function"==typeof e&&(o=t,i=e),{options:o,callback:i}},e.prototype.createSocket=function(t,e,i){var n=this;return function(o){var r=new WebSocket(n.socketUrl+t);r.onerror=function(){console.error("Error opening "+e+" socket at "+n.socketUrl+t)},r.onmessage=function(t){n.logging&&console.log(t);var o;try{o=JSON.parse(t.data)}catch(r){if('{"token":"","timestamp":0.0,"status":"STOP","moreinfo":[]}'===t.data)return void n.emit(i,{token:"",timestamp:0,status:"STOP",moreinfo:[]});console.log("Could not JSON.parse() "+e+" event.data. Payload was: '"+t.data+"'")}o&&n.emit(i,o)},o(r)}},e.prototype._dispatchWordSchedule=function(t){var e=this,i=Date.now(),n=0;t=t.tokentimes.tokens.filter(function(t){return"/pau/"!==t.name});var o=function s(){var o=t[n];if(e.emit("word",{token:o.name,timestamp:o.start,status:"PLAY",moreinfo:[]}),n++,n<t.length){var r=1e3*t[n].start,a=Date.now()-i;setTimeout(s,Math.max(r-a,0))}};if(t.length){var r=1e3*t[n].start;setTimeout(o,r)}},e.prototype._speak=function(t,e,i){var n=this;if(!this.isInitialized)return void i("TTS Service is not initialized");var o=function(){n._getWordTimings(t,e,function(o,r){if(o)i(o);else{n._dispatchWordSchedule(r);var s=new XMLHttpRequest,a=JSON.parse(JSON.stringify(p));a.prompt=t,a.duration_stretch=e.duration_stretch||a.duration_stretch,a.pitchBandwidth=e.pitchBandwidth||a.pitchBandwidth,a.pitch=e.pitch||a.pitch,a.mode=e.mode||a.mode,a=JSON.stringify(a),s.open("POST",n.httpInterface+u.SPEAK,!0),s.onreadystatechange=function(){if(4==s.readyState)if(204===s.status)n.isTalking=!1,i();else{var t="TTS Service is unavailable";void 0!==s.statusText&&""!==s.statusText&&(t=s.statusText),i(t)}},n.isTalking=!0,s.send(a)}})};if(this.isStopping){var r=function s(){n.removeListener("stopped",s),o()};this.on("stopped",r)}else this.isTalking?stop(o):o()},e.prototype.speak=function(t,e,i){var n=this,o=this.getOptionsAndCallback(e,i),r=o.callback,s=o.options;return r?void this._speak(t,s,r):new Promise(function(e,i){var o=function(t){t?i(t):e()};n._speak(t,s,o)})},e.prototype._stop=function(t){var e=this;if(!this.isInitialized)return void t();this.isStopping=!0,this.isTalking=!1;var i=new XMLHttpRequest;i.timeout=2e3,i.onreadystatechange=function(){4===i.readyState&&200===i.status&&(e.isStopping=!1,e.emit("stopped"),t())},i.open("GET",this.httpInterface+u.STOP,!0),i.send(null)},e.prototype.stop=function(t){var e=this;return t?void this._stop(t):new Promise(function(t){e._stop(t)})},e.prototype._getWordTimings=function(t,e,i){if("string"!=typeof t)throw new TypeError("Invalid params: "+t+", "+a);if(!this.isInitialized)throw new Error("Not initialized. Use .init()");var n=new XMLHttpRequest,o=JSON.parse(JSON.stringify(p));o.prompt=t,o.duration_stretch=e.duration_stretch||o.duration_stretch,o.pitchBandwidth=e.pitchBandwidth||o.pitchBandwidth,o.pitch=e.pitch||o.pitch,o=JSON.stringify(o),n.open("POST",this.httpInterface+u.TIMING,!0),n.onreadystatechange=function(){var t=4==n.readyState,e=n.status<200||n.status>=400;if(t&&200==n.status){var o=void 0;try{o=JSON.parse(n.response)}catch(r){i(r)}o&&(o.Status&&"ERROR"===o.Status?i(o):i(null,o))}else t&&e&&i(new Error("Request failed with status: "+n.status))},n.send(o)},e.prototype.getWordTimings=function(t,e,i){var n=this,o=this.getOptionsAndCallback(e,i),r=o.options,s=o.callback;return s?void this._getWordTimings(t,r,s):new Promise(function(e,i){var o=function(t,n){t?i(t):e(n)};n._getWordTimings(t,r,o)})},e.prototype._validateEffectNameParam=function(t){if("string"!=typeof t)throw new TypeError("Invalid params, name must be string: "+t);if(!this.isInitialized)throw new Error("Not connected. Cannot send action.");if(!this.effectsSocket)throw new Error("Effect socket not initialized.")},e.prototype._validateEffectValueParam=function(t){if("number"==typeof t){if(0>t||t>1)throw new TypeError("Value out of range [0, 1]: "+t)}else if("string"!=typeof t)throw new TypeError("Value must either be a number or string: "+t)},e.prototype.startEffect=function(t,e){this._validateEffectNameParam(t),this._validateEffectValueParam(e);var i={name:t,action:l.START,param:""+e};this.effectsSocket.send(JSON.stringify(i))},e.prototype.stopEffect=function(t){this._validateEffectNameParam(t);var e={name:t,action:l.STOP,param:"0"};this.effectsSocket.send(JSON.stringify(e))},e.prototype.updateEffect=function(t,e){this._validateEffectNameParam(t),this._validateEffectValueParam(e);var i={name:t,action:l.UPDATE,param:""+e};this.effectsSocket.send(JSON.stringify(i))},e}(s.EventEmitter);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=h},{async:void 0,events:void 0}],66:[function(t,e,i){"use strict";var n=t("./ASRVariables"),o=t("./AudioAction"),r=t("./SpeakerAction"),s=t("./AudioSource"),a=t("./Recognizer"),u=t("./SpeakerRecognizer"),c=t("./EndOfSpeechRecognizer"),l=t("./CloudRecognizer"),p=t("./Listener"),h=t("./Enroller"),d=function(){function t(){this.isInitialized=!1,this.msgs=[],this.listSpeakerCallbacks=[],this.deleteSpeakerCallbacks=[]}return Object.defineProperty(t.prototype,"Recognizer",{get:function(){return a["default"]},enumerable:!0,configurable:!0
}),Object.defineProperty(t.prototype,"EndOfSpeechRecognizer",{get:function(){return c["default"]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CloudRecognizer",{get:function(){return l["default"]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SpeakerRecognizer",{get:function(){return u["default"]},enumerable:!0,configurable:!0}),t.prototype.init=function(t,e){var i=this;try{this.socketUrl="ws:"+t.host+":"+t.port+"/port",this.audioUrl="http://"+t.host+":"+t.port+"/audio_source",this.asrInterfaceUrl="http://"+t.host+":"+t.port+"/asr_interface",this.speakerInterfaceUrl="http://"+t.host+":"+t.port+"/spkr_id_interface",this.socket=new WebSocket(this.socketUrl),this.loggingEnabled=!1,this.socket.onerror=function(){console.warn("error connecting to server")},this.socket.onmessage=function(t){var e=JSON.parse(t.data);for(i.msgs.push(e);!i.paused&&i.msgs.length;)i.processNextMessage()},this.alsaSource=new s["default"](this.audioUrl),this.alsaSource.init(function(t){t&&console.warn(t),i.isInitialized=!0,e()})}catch(n){console.warn(n)}},t.prototype.pause=function(){this.paused=!0},t.prototype.resume=function(){for(this.paused=!1;this.msgs.length;)this.processNextMessage()},t.prototype.processNextMessage=function(){this.processMessage(this.msgs.shift())},t.prototype.processMessage=function(t){this.loggingEnabled&&(console.log("----------------------"),console.log(t));var e=n["default"].idToAction[t.task_id],i=n["default"].idToRecognizer[t.simple_recog_name];return"error"===t.status&&(console.warn("ASR Service returned error response. Check ASR debug"),e&&e.emit("error",t.message)),"LISTING-SPEAKERS"===t.speaker_idstatus&&this.listSpeakerCallback(t),"DELETING-SPEAKER"===t.speaker_idstatus&&this.deleteSpeakerCallback(t),"ENROLLMENT-STARTED"===t.speaker_idstatus&&i.onResult(t),"Speaker ID TD"===t.simple_recog_name?(e||(console.warn("No action found"),console.log("task_id: ",t.task_id),console.log("recognizer:",i)),void e.emit("speakerid",t)):"pcmwriter"!==t.simple_recog_name?t.final_simple?i?void i.onResult(t):void console.warn("Could not find recognizer with name "+t.simple_recog_name):t.final_composite?e?(e.emit("finished",e),void e.clear()):void console.warn("Could not find action with name "+t.task_id):void(t.utterances&&t.utterances.length>0&&i&&i.onIncremental&&i.onIncremental(t)):void 0},t.prototype.createWavSource=function(t){return this.wavSource=new s["default"](this.audioUrl,t),this.wavSource},t.prototype.createWavAction=function(){var t=new o["default"](this.asrInterfaceUrl);return this.wavSource.link(t),t},t.prototype.createAudioAction=function(){var t=new o["default"](this.asrInterfaceUrl);return this.alsaSource.link(t),t},t.prototype.createSpeakerAction=function(){var t=new r["default"](this.speakerInterfaceUrl);return this.alsaSource.link(t),t},t.prototype.createSpeakerActionAsync=function(t){var e=new r["default"](this.speakerInterfaceUrl);return this.alsaSource.link(e),t(e)},t.prototype.listEnrolledSpeakers=function(t){this.listSpeakerCallbacks.push(t),this.createSpeakerActionAsync(function(t){t.listSpeakers()})},t.prototype.listSpeakerCallback=function(t){this.listSpeakerCallbacks.forEach(function(e){e(t)}),this.listSpeakerCallbacks=[]},t.prototype.deleteSpeaker=function(t,e,i){void 0===e&&(e="TD+TI"),this.deleteSpeakerCallbacks.push(i),this.createSpeakerActionAsync(function(i){i.deleteSpeaker(t,e)})},t.prototype.deleteSpeakerCallback=function(t){this.deleteSpeakerCallbacks.forEach(function(e){e(t)}),this.deleteSpeakerCallbacks=[]},t.prototype.setLogging=function(t){this.loggingEnabled=t},t.prototype.createListener=function(t,e){return new p["default"](t,e)},t.prototype.createEnroller=function(t,e){return new h["default"](t,e)},t}();d.BASE="/usr/local/share/asrservice/sharedresources/",Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=d},{"./ASRVariables":67,"./AudioAction":68,"./AudioSource":69,"./CloudRecognizer":70,"./EndOfSpeechRecognizer":71,"./Enroller":72,"./Listener":73,"./Recognizer":74,"./SpeakerAction":75,"./SpeakerRecognizer":76}],67:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={idToAction:{},idToRecognizer:{},idToAudioSource:{}}},{}],68:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("uuid"),r=t("./ASRVariables"),s=t("events"),a=function(t){function e(e){t.call(this),this.httpInterface=e,this.id="action-"+o.v4(),r["default"].idToAction[this.id]=this,this.isCleared=!1}return n(e,t),e.prototype.setAudioSourceId=function(t){this.audioSourceId=t},e.prototype.start=function(t){if(!this.isCleared){var e={action:"init_and_start",task:t,task_id:this.id,audio_source_id:this.audioSourceId};e=JSON.stringify(e);var i=new XMLHttpRequest;i.open("POST",this.httpInterface,!0),i.send(e)}},e.prototype.restart=function(t){if(!this.isCleared){var e={action:"start",task:t,task_id:this.id,audio_source_id:this.audioSourceId};e=JSON.stringify(e);var i=new XMLHttpRequest;i.open("POST",this.httpInterface,!0),i.send(e)}},e.prototype.stop=function(t){if(!this.isCleared){var e=new XMLHttpRequest,i={action:"stop",task:"",task_id:this.id,audio_source_id:this.audioSourceId};i=JSON.stringify(i),e.open("POST",this.httpInterface,!0),e.send(i),t&&t()}},e.prototype.clear=function(){if(!this.isCleared){delete r["default"].idToAction[this.id],this.isCleared=!0;var t=new XMLHttpRequest,e={action:"clear",task:"",task_id:this.id,audio_source_id:this.audioSourceId};e=JSON.stringify(e),t.open("POST",this.httpInterface,!0),t.send(e)}},e.prototype.getId=function(){return this.id},e}(s.EventEmitter);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"./ASRVariables":67,events:void 0,uuid:void 0}],69:[function(t,e,i){"use strict";var n=t("uuid"),o=t("./ASRVariables"),r=function(){function t(t,e){var i="alsa";Array.isArray(e)&&e.length>0?i="wav":"string"==typeof e&&(i="wav",e=[e]),this.id="source-"+n.v4(),o["default"].idToAudioSource[this.id]=this,this.source=i,this.wavFiles=e||[],this.audioUrl=t}return t.prototype.init=function(t){var e={action:"start",audio_source_id:this.id,audio_source:this.source,wav_files:this.wavFiles};e=JSON.stringify(e);var i=new XMLHttpRequest;i.open("POST",this.audioUrl,!0),i.onreadystatechange=function(){4!=i.readyState||204!=i.status&&200!=i.status?4==i.readyState&&0===i.status&&t("Could not create audio channel"):t()},i.send(e)},t.prototype.destroy=function(t){var e={action:"stop",audio_source_id:this.id,audio_source:this.source,wav_files:[]};e=JSON.stringify(e);var i=new XMLHttpRequest;i.open("POST",this.audioUrl,!0),i.onreadystatechange=function(){4!=i.readyState||204!=i.status&&200!=i.status?4==i.readyState&&0===i.status&&t("Could not destroy audio channel"):t()},i.send(e)},t.prototype.link=function(t){t.setAudioSourceId(this.id)},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r},{"./ASRVariables":67,uuid:void 0}],70:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./Recognizer"),r=t("../../Runtime"),s={INVALID:0,COMPILING:1,COMPILE_FAILED:2,COMPILE_SUCCEEDED:3},a=function(t){function e(e,i){i=i?i:{},i.path="nuance_curlmulti",t.call(this,i),this.rule=e,this.handle=null,this.status=s.INVALID,this.callbacks=[],this.type="cloud",this.rule&&this.compile(function(){})}return n(e,t),e.prototype.setRuleHandle=function(t){this.handle=t,this.status=s.COMPILE_SUCCEEDED},e.prototype.callCallbacks=function(t){this.callbacks.forEach(function(e){e(t)}),this.callbacks.length=0},e.prototype.compile=function(t){var e=this;this.callbacks.push(t),this.status===s.INVALID?(this.status=s.COMPILING,r["default"].instance.nlu.compile(this.rule,function(t,i){t?(e.status=s.COMPILE_FAILED,console.warn(t),e.callCallbacks("error")):(e.status=s.COMPILE_SUCCEEDED,e.handle=i,e.callCallbacks())})):this.status===s.COMPILE_FAILED?this.callCallbacks("error"):this.status===s.COMPILE_SUCCEEDED&&this.callCallbacks()},e.prototype.onResult=function(t){var e=this,i=r["default"].instance.asr,n=r["default"].instance.nlu;i.pause();var o=t.utterances[0].utterance,s=t.message_id;this.rule?this.compile(function(t){var r=t?n.parseFromRule.bind(n):n.parseFromURI.bind(n),a=t?e.rule:e.handle;r(a,o,function(t,n){t?e.emit("error",t):e.emit("result",n),i.resume()},s)}):(this.emit("result",{Input:o}),i.resume())},e.prototype.onIncremental=function(t){var e=this,i=r["default"].instance.nlu,n=t.utterances[0].utterance,o=t.message_id;this.rule?this.compile(function(t){var r=t?i.parseFromRule.bind(i):i.parseFromURI.bind(i),s=t?e.rule:e.handle;r(s,n,function(t,i){t?e.emit("error",t):e.emit("incremental",i)},o)}):this.emit("inremental",{Input:n})},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"../../Runtime":1,"./Recognizer":74}],71:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./Recognizer"),r=function(t){function e(e){e=e||{},e.path="sensory_speech_detector",e.speakerId=!1,t.call(this,e),this.type="eos"}return n(e,t),e.prototype.onResult=function(t){"normal"===t.status&&this.emit("result",t)},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r},{"./Recognizer":74}],72:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("events"),r=t("../../Runtime"),s=function(t){function e(e,i){t.call(this,e),this.callback=i,this.asr=r["default"].instance.asr,this.speakerName=e.speakerName,this.enrollmentType=e.enrollmentType,this.actions=[],this.nSavingAudios=0}return n(e,t),e.prototype.onFinished=function(){this.enroller.removeAllListeners("result"),this.enroller.removeAllListeners("need-more-data"),this.action.stop(),this.action.clear()},e.prototype._consolidateResponse=function(){return this.speakerResult?("SAVING_AUDIO"===this.speakerResult.speakerIdStatus&&(this.emit("saving-audio",++this.nSavingAudios),this.restart()),"NEED-4-MORE-UTTS"===this.speakerResult.speakerIdStatus||"NEED-3-MORE-UTTS"===this.speakerResult.speakerIdStatus||"NEED-2-MORE-UTTS"===this.speakerResult.speakerIdStatus||"NEED-1-MORE-UTTS"===this.speakerResult.speakerIdStatus?(this.emit("need-more-data",this.speakerResult.speakerIdStatus[5]),this.action=void 0,void this.restart()):"ENROLLMENT-STARTED"===this.speakerResult.speakerIdStatus?void this.emit("enrollment-started"):this.speakerResult&&"ENROLLMENT-DONE"===this.speakerResult.speakerIdStatus?(this.emit("result",this.speakerResult,this.heyJiboResult),void this.onFinished()):void 0):void this.restart()},e.prototype._addSpeakerEnroller=function(){var t=this,e="text-dependent"===this.enrollmentType;return this.enroller=new this.asr.SpeakerRecognizer({enrollTD:e,enrollTI:!e,speakerName:this.speakerName,timeout:5e3,bargein:!1,nbest:1,inremental:!1}),this.enroller.on("result",function(e){t.speakerResult=e}),""+this.enroller.pack()},e.prototype._addHeyJibo=function(){var t=this,e=new this.asr.Recognizer({path:"hey_jibo",timeout:0,bargein:!0,nbest:1,speakerName:"",incremental:!1,speakerId:!1});return e.on("result",function(e){t.heyJiboResult=e}),""+e.pack()},e.prototype.start=function(){var t=this;return this.asr.isInitialized?(this.task=this._addSpeakerEnroller(),this.task=this._addHeyJibo()+" * "+this.task,this.action=this.asr.createAudioAction(),this.action.on("finished",function(e){t._consolidateResponse(),e.stop(function(){e.clear()})}),void this.action.start(this.task)):(console.warn("Running enroller without ASR service"),!0)},e.prototype.restart=function(){var t=this;this.action=this.asr.createAudioAction(),setTimeout(function(){t.action.start(t.task)},300),this.action.on("finished",function(e){t._consolidateResponse(),e.stop(function(){e.clear()})})},e.prototype.stop=function(){this.onFinished()},e.prototype.update=function(){return this.status},e}(o.EventEmitter);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../../Runtime":1,events:void 0}],73:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("events"),r=t("../../Runtime"),s=function(t){function e(e,i){t.call(this),this.options=e,this.rule=i,this.status="INVALID"}return n(e,t),e.prototype.onFinished=function(t){void 0===t&&(t="SUCCEEDED"),this.emit("finished"),this.status=t,this.removeAllListeners(),this.action.stop(),this.action.clear()},e.prototype.heyJiboResult=function(){this.heyJiboPhrase&&this.tdSpeakerResult&&this.emit("embedded",this.heyJiboPhrase,this.tdSpeakerResult)},e.prototype.cloudResult=function(){this.asrResult&&this.tiSpeakerResult&&(this.asrResult||(this.asrResult={},this.asrResult.status="NO-RESULTS"),this.asrResult.status="GOT-RESULTS",this.asrResult.NLParse?this.asrResult.NLParse.status="GOT-PARSE":(this.asrResult.NLParse={},this.asrResult.NLParse.status="NO-PARSE"),this.emit("cloud",this.asrResult,this.tiSpeakerResult))},e.prototype.addCloudRecognizer=function(t){var e=this,i=t;i.speakerId=!1;var n=new this.asr.CloudRecognizer(this.rule,i);return this.options.precompiledHandle&&n.setRuleHandle(this.options.precompiledHandle),n.on("result",function(t){e.asrResult=t,e.cloudResult(),n.removeAllListeners("result")}),n.on("error",function(t){e.emit("error",t)}),t.incremental&&n.on("incremental",function(t){e.emit("incremental",t)}),""+n.pack()},e.prototype.addHeyJibo=function(){var t=this,e="",i=new this.asr.Recognizer({path:"hey_jibo"});return i.on("result",function(e){t.heyJiboPhrase=e,t.heyJiboResult(),i.removeAllListeners("result")}),e=this.tdReco?"("+i.pack()+" * "+this.tdReco.pack()+")":""+i.pack(),"("+e+")"},e.prototype.addSpeakerRecognizers=function(){var t=this;return this.tiReco=new this.asr.SpeakerRecognizer({authTI:!0}),this.tiReco.on("result",function(e){t.tiSpeakerResult=e,t.cloudResult(),t.tiReco.removeAllListeners("result")}),"("+this.tiReco.pack()+")"},e.prototype.addEOSRecognizer=function(){var t=this,e=new this.asr.EndOfSpeechRecognizer({});return e.on("result",function(){t.emit("end"),e.removeAllListeners("result")}),""+e.pack()},e.prototype.start=function(){var t=this;if(this.asr=r["default"].instance.asr,"IN_PROGRESS"===this.status)return this.emit("error","cannot restart; listener is currently in progress."),!1;this.status="IN_PROGRESS",this.tiSpeakerResult={},this.tiSpeakerResult.speaker_ids=[],this.tiSpeakerResult.speaker_idstatus="ID-TI-NOT-AVAILABLE",this.tdSpeakerResult=!1,this.action=this.asr.createAudioAction(),this.action.on("finished",function(){t.onFinished()}),this.action.on("speakerid",function(e){var i=e.speaker_ids,n=e.speaker_idstatus;t.tdSpeakerResult={speakerIds:i,speakerIdStatus:n},t.heyJiboResult()}),this.action.on("error",function(e){t.emit("error",e)});var e;if(this.options.embeddedOnly)e=this.addHeyJibo();else{if(e=this.addCloudRecognizer(this.options),this.options.detectEnd){var i=this.addEOSRecognizer();e="("+i+" | "+e+")"}if(this.options.heyJibo){var n=this.addHeyJibo();e="("+n+" * "+e+")"}}return this.action.start(e),!0},e.prototype.stop=function(){this.onFinished("STOPPED")},e}(o.EventEmitter);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"../../Runtime":1,events:void 0}],74:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("uuid"),r=t("./ASRVariables"),s=t("./ASRService"),a=t("events"),u=function(t){function e(e){t.call(this),this.name=e.name||o.v4(),e=e||{},this.bargein="boolean"==typeof e.bargein?e.bargein:!0,this.incremental="boolean"==typeof e.incremental?e.incremental:!1,this.timeout=e.timeout?e.timeout:0,this.speakerName=e.speakerName?e.speakerName:"",this.speakerId="boolean"==typeof e.speakerId?e.speakerId:!0,this.nbest=e.nbest||1,e.path?this.path=s["default"].BASE+e.path:this.path=s["default"].BASE+"nuance_curlmulti";var i=this.path.split("/");this.name=i[i.length-1]+"-"+this.name,r["default"].idToRecognizer[this.name]=this}return n(e,t),e.prototype.setPath=function(t){this.path=s["default"].BASE+t},e.prototype.toString=function(){return this.pack()},e.prototype.pack=function(){return JSON.stringify({name:this.name,path:this.path,bargein:this.bargein,nbest:this.nbest,speaker_name:this.speakerName,speaker_id:this.speakerId,incremental:this.incremental,timeout:this.timeout})},e.prototype.onResult=function(t){if(t.utterances&&t.utterances.length>0){var e={speaker_ids:t.speaker_ids,speaker_idstatus:t.speaker_idstatus};this.emit("result",t.utterances[0],e)}else{var e={speaker_ids:t.speaker_ids,speaker_idstatus:t.speaker_idstatus};this.emit("result","",e)}},e}(a.EventEmitter);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=u},{"./ASRService":66,"./ASRVariables":67,events:void 0,uuid:void 0}],75:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("uuid"),r=t("./ASRVariables"),s=t("events"),a=function(t){function e(e){t.call(this),this.httpInterface=e,this.id="spkr-action-"+o.v4(),r["default"].idToAction[this.id]=this}return n(e,t),e.prototype.setAudioSourceId=function(t){this.audioSourceId=t},e.prototype.deleteSpeaker=function(t,e){void 0===t&&(t="");var i=new XMLHttpRequest,n={action:"delete",task_id:this.id,spkr_id_type:e,speaker_name:t};n=JSON.stringify(n),i.open("POST",this.httpInterface,!0),i.send(n)},e.prototype.listSpeakers=function(t,e){void 0===t&&(t="");var i=new XMLHttpRequest,n={action:"list",task_id:this.id,spkr_id_type:e||"TD+TI",speaker_name:t};n=JSON.stringify(n),i.open("POST",this.httpInterface,!0),i.send(n)},e}(s.EventEmitter);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"./ASRVariables":67,events:void 0,uuid:void 0}],76:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./Recognizer"),r=function(t){function e(e){void 0===e&&(e={}),e.enrollTD?e.path="sensory_spkr_enroll_td":e.enrollTI?e.path="sensory_spkr_enroll_ti":e.authTD?e.path="sensory_spkr_id_td":e.authTI&&(e.path="sensory_spkr_id_ti"),e.name="Speaker Enroll TD",t.call(this,e)}return n(e,t),e.prototype.toString=function(){return this.pack()},e.prototype.pack=function(){var t={name:this.name,path:this.path,bargein:this.bargein,nbest:this.nbest,timeout:this.timeout,speaker_name:this.speakerName,incremental:this.incremental,audio_tail_length:1};return t=JSON.stringify(t)},e.prototype.onResult=function(t){var e={speakerIds:t.speaker_ids,speakerIdStatus:t.speaker_idstatus};this.emit("result",e)},e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r},{"./Recognizer":74}],77:[function(t,e,i){"use strict";var n=t("./ASRService"),o=t("./ASRVariables"),r=t("./AudioAction"),s=t("./AudioSource"),a=t("./CloudRecognizer"),u=t("./EndOfSpeechRecognizer"),c=t("./Listener"),l=t("./Recognizer"),p=t("./SpeakerAction"),h=t("./SpeakerRecognizer");Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={ASRService:n["default"],ASRVariables:o["default"],AudioAction:r["default"],AudioSource:s["default"],CloudRecognizer:a["default"],EndOfSpeechRecognizer:u["default"],Listener:c["default"],Recognizer:l["default"],SpeakerAction:p["default"],SpeakerRecognizer:h["default"]}},{"./ASRService":66,"./ASRVariables":67,"./AudioAction":68,"./AudioSource":69,"./CloudRecognizer":70,"./EndOfSpeechRecognizer":71,"./Listener":73,"./Recognizer":74,"./SpeakerAction":75,"./SpeakerRecognizer":76}],78:[function(t,e,i){"use strict";var n=t("./SystemManager"),o=t("./SessionManager"),r=t("./TTSService"),s=t("./BodyService"),a=t("./LPSService"),u=t("./NLUService"),c=t("./asr"),l=t("./AudioService");Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={asr:c["default"],SystemManager:n["default"],SessionManager:o["default"],TTSService:r["default"],BodyService:s["default"],LPSService:a["default"],NLUService:u["default"],AudioService:l["default"]}},{"./AudioService":59,"./BodyService":60,"./LPSService":61,"./NLUService":62,"./SessionManager":63,"./SystemManager":64,"./TTSService":65,"./asr":77}],79:[function(t,e,i){"use strict";var n=function(){function t(t){this._context=t,this._firstNode=null,this._lastNode=null,this._nodes={}}return t.prototype.destroy=function(){this._nodes=null,this._context=null,this._firstNode=null,this._lastNode=null},t.prototype.nodes=function(){return this._nodes},t.prototype.first=function(){return this._firstNode},t.prototype.last=function(){return this._lastNode},t.prototype._addNode=function(t,e){var i=this._lastNode&&"playbackRate"in this._lastNode;i&&(this._bufferSourceDst=t),this._lastNode&&this._lastNode.connect(t),this._firstNode||(this._firstNode=t),this._lastNode=t;for(var n in e)t[n]=e[n];return this},t.prototype.cloneBufferSource=function(){console.assert(this._nodes.bufferSource,"No buffersource presents. Add one.");var t=this._nodes.bufferSource,e=this._context.createBufferSource();return e.buffer=t.buffer,e.playbackRate.value=t.playbackRate.value,e.loop=t.loop,e.connect(this._bufferSourceDst),e},t.prototype.bufferSource=function(t){var e=this._context.createBufferSource();return this._nodes.bufferSource=e,this._addNode(e,t)},t.prototype.panner=function(t){var e=this._context.createStereoPanner();return this._nodes.panner=e,this._addNode(e,t)},t.prototype.analyser=function(t){var e=this._context.createAnalyser();return this._nodes.analyser=e,this._addNode(e,t)},t.prototype.gainNode=function(t){var e=this._context.createGain();return this._nodes.gainNode=e,this._addNode(e,t)},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n},{}],80:[function(t,e,i){"use strict";var n=t("./ChainBuilder"),o=t("./SoundInstance"),r=function(){function e(t,e){("string"==typeof e||e instanceof ArrayBuffer)&&(e={src:e}),e=Object.assign({autoPlay:!1,block:!1,src:null,useXHR:!1,preload:!1,volume:1,panning:0,complete:null,loaded:null,loop:!1},e||{}),this._context=t,this._ctx=this._context.context,this._chain=new n["default"](this._ctx).bufferSource().gainNode().analyser().panner(),this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=e.autoPlay,this.block=e.block,this.preload=e.preload,this.complete=e.complete,this.loaded=e.loaded,this.src=e.src,this.useXHR=e.useXHR,this._instances=[],this._chain.last().connect(this._context._entryNode()),this._source=this._chain.nodes().bufferSource,this._gainNode=this._chain.nodes().gainNode,this._analyser=this._chain.nodes().analyser,this._panner=this._chain.nodes().panner,console.assert(this._source,"No bufferSource: not yet supported"),console.assert(this._gainNode,"No gainNode: not yet supported"),console.assert(this._analyser,"No analyser: not yet supported"),console.assert(this._panner,"No panner: not yet supported"),this.volume=e.volume,this.panning=e.panning,this.loop=e.loop,this.preload&&this._beginPreload()}return e.prototype._beginPreload=function(){if("string"==typeof this.src)this.useXHR?this.loadUrl():this.loadPath();else{if(!(this.src instanceof ArrayBuffer))throw new Error("sound src must be ArrayBuffer or string");this.decode(this.src)}},e.prototype.destroy=function(){this._chain.last().disconnect(),this._chain.destroy(),this._chain=null,this._context=null,this._ctx=null,this._source=null,this._removeInstances(),this._instances=null},Object.defineProperty(e.prototype,"isPlayable",{get:function(){return this.isLoaded&&!!this._source.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nodes",{get:function(){return this._chain.nodes()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._gainNode.gain.value},set:function(t){this._gainNode.gain.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._source.loop},set:function(t){this._source.loop=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffer",{get:function(){return this._source.buffer},set:function(t){this._source.buffer=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"panning",{get:function(){return this._panner.pan},set:function(t){this._panner.pan.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instances",{get:function(){return this._instances},enumerable:!0,configurable:!0}),e.prototype.play=function(t){var e=this;if("function"==typeof t&&(t={complete:t}),t=Object.assign({complete:null,loaded:null,offset:0},t||{}),this.isPlayable){this.block&&this._removeInstances();var i=o["default"].create(this._chain);return this._instances.push(i),this.isPlaying=!0,i.once("complete",function(){e._onComplete(i),t.complete&&t.complete(e)}),i.play(t.offset),i}if(this.autoPlay=!0,!this.isLoaded){var n=t.loaded;n&&(this.loaded=n),this._beginPreload()}},e.prototype._onComplete=function(t){if(this._instances){var e=this._instances.indexOf(t);e>-1&&this._instances.splice(e,1),this.isPlaying=this._instances.length>0}t.destroy()},e.prototype.stop=function(){return this.isPlayable?(this.isPlaying=!1,this._instances.forEach(function(t){t.stop()}),this):(this.autoPlay=!1,this)},e.prototype.pause=function(){return this._instances.forEach(function(t){t.paused=!0}),this.isPlaying=!1,this},e.prototype.resume=function(){return this._instances.forEach(function(t){t.paused=!1}),this.isPlaying=this._instances.length>0,this},e.prototype._removeInstances=function(){this._instances.forEach(function(t){t.destroy()}),this._instances.length=0},e.prototype.loadUrl=function(){var t=this,e=new XMLHttpRequest;e.open("GET",this.src,!0),e.responseType="arraybuffer",e.onload=function(){t.isLoaded=!0,t.decode(e.response)},e.send()},e.prototype.loadPath=function(){var e=this,i=t("fs");i.readFile(this.src,function(t,i){if(t)throw console.error(t),new Error("File not found "+e.src);for(var n=new ArrayBuffer(i.length),o=new Uint8Array(n),r=0;r<i.length;++r)o[r]=i[r];e.decode(n)})},e.prototype.decode=function(t){var e=this;this._ctx.decodeAudioData(t,function(t){e.isLoaded=!0,e.buffer=t,e.loaded&&e.loaded(e),e.autoPlay&&e.play(e.complete)},function(){throw new Error("Unable to decode file")})},e}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r},{"./ChainBuilder":79,"./SoundInstance":82,fs:void 0}],81:[function(t,e,i){"use strict";var n=function(){function t(){this._ctx=new AudioContext,this._gainNode=this._ctx.createGain(),this._compressor=this._ctx.createDynamicsCompressor(),this._gainNode.connect(this._compressor),this._compressor.connect(this._ctx.destination),this.volume=1,this.muted=!1,this.paused=!1}return t.prototype.destroy=function(){this._ctx=null,this._gainNode=null,this._compressor=null},Object.defineProperty(t.prototype,"context",{get:function(){return this._ctx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=!!t,this._gainNode.gain.value=this._muted?0:this._volume},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this._muted||(this._gainNode.gain.value=this._volume)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){t&&"running"===this._ctx.state?this._ctx.suspend():t||"suspended"!==this._ctx.state||this._ctx.resume(),this._paused=t},enumerable:!0,configurable:!0}),t.prototype._entryNode=function(){return this._gainNode},t.prototype.toggleMute=function(){return this.muted=!this.muted,this._muted},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n},{}],82:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("events"),r=0,s=function(t){function e(e){t.call(this),this.id=r++,this._chain=null,this._startTime=0,this._paused=!1,this._currentPosition=0,this.init(e)}return n(e,t),e.create=function(t){if(e._pool.length>0){var i=e._pool.pop();return i.init(t),i}return new e(t)},e.prototype.init=function(t){this._chain=t},e.prototype.stop=function(){this._source&&(this._source.onended=null,this._source.stop(),this._source=null)},e.prototype.play=function(t){this._source=this._chain.cloneBufferSource(),this._startTime=Date.now(),this._source.onended=this._onComplete.bind(this),this._source.start(0,t||0)},Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){t!==this._paused&&(this._paused=t,t?(this.stop(),this._currentPosition=Date.now()-this._startTime):this.play(this._currentPosition/1e3))},enumerable:!0,configurable:!0}),e.prototype._onComplete=function(){this._source&&(this._source.onended=null),this._source=null,this.emit("complete",this)},e.prototype.destroy=function(){this.removeAllListeners("complete"),this.stop(),this._source&&(this._source.onended=null),this._source=null,this._chain=null,this._startTime=0,this._paused=!1,this._currentPosition=0,e._pool.indexOf(this)<0&&e._pool.push(this)},e.prototype.toString=function(){return"[SoundInstance id="+this.id+"]"},e._pool=[],e}(o.EventEmitter);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{events:void 0}],83:[function(t,e,i){"use strict";var n=t("./SoundContext"),o=t("./Sound"),r=t("./SoundInstance"),s=t("./SoundUtils"),a=function(){function t(){if(t._instance)throw new Error("Only one SoundLibrary can be created at once");t._instance=this,this._context=new n["default"],this._sounds={},this.SoundUtils=s["default"],this.Sound=o["default"],this.SoundInstance=r["default"]}return Object.defineProperty(t,"instance",{get:function(){return t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e){console.assert(!this._sounds[t],"Sound with alias "+t+" already exists.");var i=this._sounds[t]=new o["default"](this.context,e);return i},t.prototype.addMap=function(t,e){var i={};for(var n in t){var o=void 0;o="string"==typeof t[n]||t[n]instanceof ArrayBuffer?{src:t[n]}:t[n],console.log(o),i[n]=this.add(n,Object.assign(o,e||{}))}return i},t.prototype.remove=function(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this},t.prototype.pauseAll=function(){return this._context.paused=!0,this},t.prototype.resumeAll=function(){return this._context.paused=!1,this},t.prototype.muteAll=function(){return this._context.muted=!0,this},t.prototype.unmuteAll=function(){return this._context.muted=!1,this},t.prototype.removeAll=function(){for(var t in this._sounds)this._sounds[t].destroy();return this},t.prototype.stopAll=function(){for(var t in this._sounds)this._sounds[t].stop();return this},t.prototype.exists=function(t,e){void 0===e&&(e=!1);var i=!!this._sounds[t];return e&&console.assert(i,"No sound matching alias '"+t+"'."),i},t.prototype.play=function(t,e){return this.exists(t,!0),this._sounds[t].play(e)},t.prototype.stop=function(t){return this.exists(t,!0),this._sounds[t].stop()},t.prototype.pause=function(t){return this.exists(t,!0),this._sounds[t].pause()},t.prototype.resume=function(t){return this.exists(t,!0),this._sounds[t].resume()},t.prototype.destroy=function(){this.removeAll(),this._sounds=null,this.context=null},t}();Object.defineProperty(i,"__esModule",{
value:!0}),i["default"]=a},{"./Sound":80,"./SoundContext":81,"./SoundInstance":82,"./SoundUtils":84}],84:[function(t,e,i){"use strict";var n=t("./Sound"),o=t("./SoundLibrary"),r=t("uuid"),s=function(){function t(){}return t.sineTone=function(t,e){var i=o["default"].instance.context,r=new n["default"](i,{block:!0});t=t||200,e=e||1;for(var s=1,a=48e3,u=2,c=i.context.createBuffer(s,e*a,a),l=c.getChannelData(0),p=0;p<l.length;p++){var h=p/c.sampleRate,d=t*h*Math.PI;l[p]=Math.sin(d)*u}return r.buffer=c,r.isLoaded=!0,r},t.playOnce=function(t,e){var i=r.v4();return o["default"].instance.add(i,{autoPlay:!0,src:t,preload:!0,complete:function(){o["default"].instance.remove(i),e&&e()}}),i},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"./Sound":80,"./SoundLibrary":83,uuid:void 0}],85:[function(t,e,i){"use strict";var n=t("./Sound"),o=t("./SoundContext"),r=t("./ChainBuilder"),s=t("./SoundLibrary"),a=t("./SoundInstance"),u=t("./SoundUtils");Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={Sound:n["default"],SoundContext:o["default"],ChainBuilder:r["default"],SoundLibrary:s["default"],SoundInstance:a["default"],SoundUtils:u["default"]}},{"./ChainBuilder":79,"./Sound":80,"./SoundContext":81,"./SoundInstance":82,"./SoundLibrary":83,"./SoundUtils":84}],86:[function(t,e,i){"use strict";function n(t){u.animate.createAnimationUtilities=function(){return console.warn("Warning: createAnimationUtilities() is deprecated. Access anim utils via jibo.animate."),t},t.createAnimationUtilities=function(){return t},t.createAnimationBuilderFromKeysPath=function(e,i,n){h["default"].getProjectRoot(function(o,r){h["default"].getBaseDirectory(l.parse(e).dir,function(o,s){c.keysToAnimObjectAsync(e,function(o){function u(t,e,i){h["default"].getAudioUri(i.file,s===r?"":s,function(t){p["default"].playOnce(t)})}function c(){l.off("playAudio",u),l.off("STOPPED",c)}var l=t.createAnimationBuilderFromData(o,i);a&&new d["default"](a,l,e,s===r?"":s),l.on("play-audio",u),l.on("STOPPED",c),n(l)})})})},t.MODALITY_NAME=u.animate.MODALITY_NAME,t.trajectory=u.animate.trajectory,t.AnimationEventType=u.animate.AnimationEventType,t.LookatEventType=u.animate.LookatEventType,t.THREE=u.THREE}function o(){u.visualize.robotInfo=r,u.visualize.timeline=s,u.visualize.createFaceRenderer=function(t){return a?a:(a=f["default"].face,a.init(t),s.addOutput(new u.AuxOutput(r,a)),a)};var t=u.visualize.createRobotRenderer;u.visualize.createRobotRenderer=function(e,i,n){t(r,e,i,function(t){null!==t?(u.TimelineBuilder.connectRenderer(s,t),n&&n(null,t)):n&&n("Renderer creation failed")})}}var r,s,a,u=t("animation-utilities"),c=t("jibo-keyframes"),l=t("path"),p=t("../sound/SoundUtils"),h=t("../utils/PathUtils"),d=t("./FacePlayer"),f=t("../jibo"),v=function(){function t(){}return t.init=function(t,e){var i=new u.JiboConfig;u.RobotInfo.createInfo(i,function(i){u.TimelineBuilder.createTimeline(i,function(a){r=i,s=a,t.init(s,r),n(t),o(),e()})})},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=v},{"../jibo":50,"../sound/SoundUtils":84,"../utils/PathUtils":89,"./FacePlayer":88,"animation-utilities":void 0,"jibo-keyframes":void 0,path:void 0}],87:[function(t,e,i){"use strict";var n=function(){function t(t,e,i,n){n=Object.assign({repeat:!1,autoDestroy:!0,useFrames:!1},n||{}),this.parent=t,this._callback=e,this._delay=i,this._timer=i,this._repeat=!!n.repeat,this._autoDestroy=!!n.autoDestroy,this._useFrames=!!n.useFrames,this._paused=!1,this._update=this.update.bind(this),this.enabled=!0}return t.prototype.update=function(t){return this._callback?(this._timer-=this._useFrames?1:t,void(this._timer<=0&&(this._callback(this),this._repeat?this._timer+=this._delay:this._autoDestroy?this.destroy():this.enabled=!1))):void this.destroy()},t.prototype.restart=function(){this._callback&&(this.enabled||(this.enabled=!0),this._timer=this._delay,this._paused=!1)},t.prototype.stop=function(){this.enabled=!1,this._paused=!1},Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t,this.parent.removeListener("update",this._update),t&&this.parent.on("update",this._update)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){this._callback&&(this._paused&&!t?(this._paused=!1,this.enabled||(this.enabled=!0)):t&&this.enabled&&(this._paused=!0,this.enabled=!1))},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.stop(),this._callback=null},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n},{}],88:[function(t,e,i){"use strict";var n=t("./PathUtils"),o=t("path"),r=t("fs"),s=function(){function t(){}return t}(),a=function(){function e(t,e,i,n){this.renderer=t,this.builder=e,this.assetPack=n,this.layers=[],this.animationNum=0;try{for(var o=JSON.parse(r.readFileSync(i,"utf8")),a=0;a<o.layers.length;a++)if("Eye"===o.layers[a].type){var u=new s;u.container=this.renderer.eye.stage,u.layerNum=a,u.name="Eye",this.layers.push(u);break}}catch(c){this.keys=null}this.onPlay=this.onPlay.bind(this),this.onBuilderStopped=this.onBuilderStopped.bind(this),e.on("play-pixi",this.onPlay),e.on("STOPPED",this.onBuilderStopped)}return e.prototype.onBuilderStopped=function(){var t=this;this.renderer.renderOnlyWhenDirty=!0,this.builder.off("play-pixi",this.onPlay),this.builder.off("STOPPED",this.onBuilderStopped),this.layers.forEach(function(e){"Eye"!==e.name&&t.renderer.stage.removeChild(e.container)})},e.prototype.reorder=function(){var t=this;this.layers=this.layers.sort(function(t,e){return t.layerNum-e.layerNum}),this.layers.forEach(function(e){t.renderer.stage.addChild(e.container),"Eye"===e.name&&t.renderer.stage.addChild(t.renderer.eyeOverlay.stage)})},e.prototype.onPlay=function(e,i,r){var a=this;this.animationNum++,this.renderer.renderOnlyWhenDirty=!1;var u=n["default"].setDefaultPath("timelines",r.file);n["default"].getProjectRoot(function(e){n["default"].getAssetUri(u,a.assetPack,function(i){var n=new s;n.container=new PIXI.Container,n.layerNum=r.layerNum,n.name=r.file,a.layers.push(n);var u=t(i);PIXI.animate.load(u.stage,n.container,function(t){t.play(),a.reorder()},o.join(e,"timelines"))})})},e}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=a},{"./PathUtils":89,fs:void 0,path:void 0}],89:[function(t,e,i){"use strict";var n=t("fs"),o=t("path"),r=t("module"),s=function(){function e(){}return e.getBaseDirectory=function(i,r){n.readdir(i,function(n,s){for(var a=!1,u=0;u<s.length;u++)"package.json"===o.parse(s[u]).base&&(a=!0,r(i,t(o.join(i,s[u])).name));a||e.getBaseDirectory(o.resolve(i,".."),r)})},e.getProjectRoot=function(t){e.getBaseDirectory(process.cwd(),t)},e.setDefaultPath=function(t,e){var i=e.split("://");return e=1===i.length?o.join(t,e):i[0]+"://"+t+"/"+i[1]},e.getAssetPack=function(t){var e=t.split("://");return 1===e.length?"":e[0]},e.getAssetUri=function(t,i,n){var r=t.split("://");if(1===r.length&&i){var s=o.join(e.resolve(i+"/package.json"),".."),a=o.join(s,t);n(a,s)}else if(2===r.length){var s=o.join(e.resolve(r[0]+"/package.json"),".."),a=o.join(s,r[1]);n(a,s)}else if(1===r.length){var u=t;e.getProjectRoot(function(t){var e=o.join(t,u);n(e,t)})}},e.getAudioUri=function(t,i,n){var o=e.setDefaultPath("audio",t);e.getAssetUri(o,i,n)},e.resolve=function(t){var e=o.resolve(process.cwd()),i=o.join(e,"noop.js");try{return r._resolveFilename(t,{id:i,filename:i,paths:r._nodeModulePaths(e)})}catch(n){return null}},e}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{fs:void 0,module:void 0,path:void 0}],90:[function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./DelayedCall"),r=t("events"),s=function(t){function e(){t.call(this),this.update=this.update.bind(this),this._paused=!0}return n(e,t),e.prototype.start=function(){this._paused&&(this.emit("pause",!1),this.emit("resumed"),this._paused=!1,this._lastUpdate=performance.now(),this.update())},e.prototype.stop=function(){this._paused||(this.emit("pause",!0),this.emit("paused"),this._paused=!0,this._frameRequest&&(cancelAnimationFrame(this._frameRequest),this._frameRequest=null))},e.prototype.update=function(){if(!this._paused){var t=performance.now(),e=t-this._lastUpdate;this.emit("update",e),this._lastUpdate=t,this._frameRequest=requestAnimationFrame(this.update)}},Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},enumerable:!0,configurable:!0}),e.prototype.setTimeout=function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!0),new o["default"](this,t,e,{repeat:!1,autoDestroy:n,useFrames:i})},e.prototype.setInterval=function(t,e,i){return void 0===i&&(i=!1),new o["default"](this,t,e,{repeat:!0,autoDestroy:!1,useFrames:i})},e.prototype.destroy=function(){this.removeAllListeners(),this.stop()},e}(r.EventEmitter);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"./DelayedCall":87,events:void 0}],91:[function(t,e,i){"use strict";var n=t("./PathUtils"),o=t("./AnimationUtils"),r=t("./Timer"),s=t("./DelayedCall"),a=t("./perf");Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={AnimationUtils:o["default"],PathUtils:n["default"],Timer:r["default"],DelayedCall:s["default"],perf:a["default"]}},{"./AnimationUtils":86,"./DelayedCall":87,"./PathUtils":89,"./Timer":90,"./perf":96}],92:[function(t,e,i){"use strict";var n=t("./SerialTimer"),o=t("assert"),r=null,s=function(){function t(){}return t.init=function(){return o(null===r,"GlobalPerfTimer.init() should only be called once"),t.reset()},t.reset=function(){return r=new n["default"]("jibo")},t.get=function(){return r},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{"./SerialTimer":95,assert:void 0}],93:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./PerformanceTimer"),r=function(t){function e(e,i){t.call(this,e,o["default"].TimerTypes.PARALLEL,i)}return n(e,t),e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r},{"./PerformanceTimer":94}],94:[function(t,e,i){"use strict";function n(t,e){var i="-";t.parent?t.parent.type===r.PARALLEL&&(i="~"):i=" ";var o="";return o+=""+e+i+' "'+t.name+'" '+(t.end-t.start).toFixed(1)+"ms\n",t.type===r.PARALLEL&&t.children.sort(function(t,e){return t.end-t.start<e.end-e.start}),t.children.forEach(function(t){o+=n(t,e+"	")}),o}var o=t("assert"),r={SERIAL:"SERIAL",PARALLEL:"PARALLEL"},s=function(){function t(t,e,i){this.name=t,this.type=e,this.parent=i,this.start=this.now(),this.children=[],this.parent&&this.parent.children.push(this)}return Object.defineProperty(t,"TimerTypes",{get:function(){return r},enumerable:!0,configurable:!0}),t.prototype.stop=function(){o(!this.end,"PerformanceTimer.stop() was called twice."),this.end=this.now()},t.prototype.getTimings=function(){return o(null!==this,"PerformanceTimer.printTimings() called without there being any timing data"),n(this,"")},t.prototype.now=function(){return"undefined"!=typeof performance?performance.now():Date.now()},t}();Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=s},{assert:void 0}],95:[function(t,e,i){"use strict";var n=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=t("./PerformanceTimer"),r=function(t){function e(e,i){t.call(this,e,o["default"].TimerTypes.SERIAL,i)}return n(e,t),e}(o["default"]);Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r},{"./PerformanceTimer":94}],96:[function(t,e,i){"use strict";var n=t("./GlobalPerfTimer"),o=t("./PerformanceTimer"),r=t("./ParallelTimer"),s=t("./SerialTimer");Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={GlobalPerfTimer:n["default"],PerformanceTimer:o["default"],ParallelTimer:r["default"],SerialTimer:s["default"]}},{"./GlobalPerfTimer":92,"./ParallelTimer":93,"./PerformanceTimer":94,"./SerialTimer":95}],97:[function(t,e,i){"use strict";var n=t("./utils/perf/GlobalPerfTimer"),o=t("./utils/perf/SerialTimer");n["default"].init();var r=new o["default"]("jibo required",n["default"].get()),s=t("./jibo")["default"];r.stop(),e.exports=s},{"./jibo":50,"./utils/perf/GlobalPerfTimer":92,"./utils/perf/SerialTimer":95}]},{},[97])(97)});